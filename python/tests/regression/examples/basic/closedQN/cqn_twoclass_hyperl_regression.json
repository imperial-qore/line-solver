{
  "cell_content": {
    "cell_0": {
      "cell_type": "code",
      "source": "from line_solver import *\nimport numpy as np\nGlobalConstants.set_verbose(VerboseLevel.STD)",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-30T22:13:09.598388Z",
          "start_time": "2025-07-30T22:13:08.666239Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-03T15:32:01.918798Z",
          "iopub.execute_input": "2026-01-03T15:32:01.918996Z",
          "shell.execute_reply": "2026-01-03T15:32:02.558825Z",
          "iopub.status.idle": "2026-01-03T15:32:02.559303Z"
        }
      },
      "outputs": [],
      "execution_count": 1
    },
    "cell_1": {
      "cell_type": "code",
      "source": "model = Network('model')\n\nnode = np.empty(2, dtype=object)\nnode[0] = Delay(model, 'Delay')\nnode[1] = Queue(model, 'Queue1', SchedStrategy.PS)\n\njobclass = np.empty(2, dtype=object)\njobclass[0] = ClosedClass(model, 'Class1', 2, node[0], 0)\njobclass[1] = ClosedClass(model, 'Class2', 2, node[0], 0)\n\nnode[0].set_service(jobclass[0], Erlang(3, 2))\nnode[0].set_service(jobclass[1], HyperExp(0.5, 3.0, 10.0))\n\nnode[1].set_service(jobclass[0], HyperExp(0.1, 1.0, 10.0))\nnode[1].set_service(jobclass[1], Exp(1))\n\nP = model.init_routing_matrix()\nP.set(jobclass[0], jobclass[0], node[0], node[0], 0.3)\nP.set(jobclass[0], jobclass[0], node[0], node[1], 0.1)\nP.set(jobclass[0], jobclass[0], node[1], node[0], 0.2)\n\nP.set(jobclass[0], jobclass[1], node[0], node[0], 0.6)\nP.set(jobclass[0], jobclass[1], node[1], node[0], 0.8)\n\nP.set(jobclass[1], jobclass[0], node[1], node[0], 1.0)\n\nP.set(jobclass[1], jobclass[1], node[0], node[1], 1.0)\n\nmodel.link(P)",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-30T22:13:09.678381Z",
          "start_time": "2025-07-30T22:13:09.650388Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-03T15:32:02.563012Z",
          "iopub.execute_input": "2026-01-03T15:32:02.563197Z",
          "shell.execute_reply": "2026-01-03T15:32:02.566720Z",
          "iopub.status.idle": "2026-01-03T15:32:02.567091Z"
        }
      },
      "outputs": [],
      "execution_count": 2
    },
    "cell_2": {
      "cell_type": "code",
      "source": "# Aligned with JAR test scenarios for cqn_twoclass_hyperl\n# JAR tests: CTMC(), JMT(seed=23000, samples=5000), SSA(seed=23000, samples=5000),\n#           Fluid(), MVA(method=\"exact\"), NC(method=\"exact\"), MAM(), DES(seed=23000, samples=5000)\n\nsolver = np.array([], dtype=object)\n\n# CTMC with default settings (matches JAR)\nsolver = np.append(solver, CTMC(model))\n\n# JMT with seed=23000, samples=5000 (matches JAR)\nsolver = np.append(solver, JMT(model, seed=23000, samples=5000))\n\n# SSA with seed=23000, samples=5000 (matches JAR)\nsolver = np.append(solver, SSA(model, seed=23000, samples=5000))\n\n# Fluid with default settings (matches JAR)\nsolver = np.append(solver, FLD(model))\n\n# MVA with method=\"exact\" (matches JAR)\nsolver = np.append(solver, MVA(model, method='exact'))\n\n# NC with method=\"exact\" (matches JAR)\nsolver = np.append(solver, NC(model, method='exact'))\n\n# MAM with default settings (matches JAR)\nsolver = np.append(solver, MAM(model))\n\n# DES with seed=23000, samples=5000 (matches MATLAB)\nsolver = np.append(solver, DES(model, seed=23000, samples=5000))\n\nAvgTable = np.empty(len(solver), dtype=object)\nfor s in range(len(solver)):\n    print(f'\\\\nSOLVER: {solver[s].get_name()}')\n    AvgTable[s] = solver[s].avg_table()",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-30T22:13:18.104849Z",
          "start_time": "2025-07-30T22:13:09.703900Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-03T15:32:02.567868Z",
          "iopub.execute_input": "2026-01-03T15:32:02.567971Z",
          "shell.execute_reply": "2026-01-03T15:32:04.682866Z",
          "iopub.status.idle": "2026-01-03T15:32:04.687034Z"
        }
      },
      "outputs": [
        {
          "output_type": "stream",
          "execution_count": null,
          "metadata": {},
          "content": {
            "stream_name": "stdout",
            "text": "\\nSOLVER: CTMC\nStation JobClass       QLen       Util  RespT     ResidT       ArvR       Tput\n  Delay   Class1 1.3604e+00 1.3604e+00 0.6667 6.6667e-01 2.0406e+00 2.0406e+00\n  Delay   Class2 1.2027e-17 1.2027e-17 0.2167 1.4920e-17 5.5511e-17 5.5511e-17\n Queue1   Class1 6.3962e-01 1.9385e-01 0.6269 3.1345e-01 1.0203e+00 1.0203e+00\n Queue1   Class2 2.0000e+00 8.0615e-01 2.4809 2.4809e+00 8.0615e-01 8.0615e-01\n\\nSOLVER: JMT\n",
            "numerical_values": [
              1.0,
              1.3604,
              1.3604,
              0.6667,
              0.66667,
              2.0406,
              2.0406,
              2.0,
              1.2027e-17,
              1.2027e-17,
              0.2167,
              1.492e-17,
              5.5511e-17,
              5.5511e-17,
              1.0,
              1.0,
              0.63962,
              0.19385,
              0.6269,
              0.31345,
              1.0203,
              1.0203,
              1.0,
              2.0,
              2.0,
              0.80615,
              2.4809,
              2.4809,
              0.80615,
              0.80615
            ]
          }
        },
        {
          "output_type": "stream",
          "execution_count": null,
          "metadata": {},
          "content": {
            "stream_name": "stdout",
            "text": "Station JobClass   QLen   Util  RespT  ResidT   ArvR   Tput\n  Delay   Class1 1.0808 1.0808 0.6619  0.6619 1.4927 1.4927\n  Delay   Class2 0.1959 0.1959 0.2166  0.2166 0.9509 0.9509\n Queue1   Class1 0.0847 0.0305 0.5264  0.5264 0.1564 0.1564\n Queue1   Class2 2.6841 0.9385 2.9622  2.9622 0.9441 0.9441\n\\nSOLVER: SSA\nStation JobClass   QLen   Util  RespT  ResidT   ArvR   Tput\n  Delay   Class1 0.9236 0.9236 0.6364  0.6364 1.4513 1.4513\n  Delay   Class2 0.2172 0.2172 0.2257  0.2257 0.9626 0.9626\n Queue1   Class1 0.0707 0.0241 0.5608  0.5608 0.1260 0.1260\n Queue1   Class2 2.7885 0.9522 2.9031  2.9031 0.9605 0.9605\n\\nSOLVER: Fluid\nStation JobClass   QLen   Util  RespT  ResidT   ArvR   Tput\n  Delay   Class1 0.9537 0.9537 0.6667  0.6667 1.4306 1.4306\n  Delay   Class2 0.2108 0.2108 0.2167  0.2167 0.9728 0.9728\n Queue1   Class1 0.0771 0.0272 0.5387  0.5387 0.1431 0.1431\n Queue1   Class2 2.7584 0.9728 2.8355  2.8355 0.9728 0.9728\n\\nSOLVER: MVA\nStation JobClass   QLen   Util  RespT  ResidT   ArvR   Tput\n  Delay   Class1 0.5540 0.5540 0.3968  0.3968 1.3962 1.3962\n  Delay   Class2 0.0833 0.0833 0.0877  0.0877 0.9494 0.9494\n Queue1   Class1 0.0361 0.1251 0.2588  0.2588 0.1396 0.1396\n Queue1   Class2 1.2934 0.8508 1.3623  1.3623 0.9494 0.9494\n\\nSOLVER: NC\nStation JobClass   QLen   Util  RespT  ResidT   ArvR   Tput\n  Delay   Class1 0.6765 0.9308 0.4845  0.4845 1.3962 1.3962\n  Delay   Class2 0.4600 0.2057 0.4845  0.4845 0.9494 0.9494\n Queue1   Class1 0.3671 0.0265 2.6295  2.6295 0.1396 0.1396\n Queue1   Class2 2.4964 0.9494 2.6295  2.6295 0.9494 0.9494\n\\nSOLVER: MAM\nStation JobClass    QLen   Util   RespT  ResidT   ArvR   Tput\n  Delay   Class1  0.6431 0.6431  0.6667  0.6667 0.9646 0.9646\n  Delay   Class2  0.2090 0.2090  0.2167  0.2167 0.9646 0.9646\n Queue1   Class1  0.3075 0.1833  0.3187  0.3187 0.9646 0.9646\n Queue1   Class2 27.2727 0.9646 28.2727 28.2727 0.9646 0.9646\n\\nSOLVER: DES\n",
            "numerical_values": [
              1.0,
              1.0808,
              1.0808,
              0.6619,
              0.6619,
              1.4927,
              1.4927,
              2.0,
              0.1959,
              0.1959,
              0.2166,
              0.2166,
              0.9509,
              0.9509,
              1.0,
              1.0,
              0.0847,
              0.0305,
              0.5264,
              0.5264,
              0.1564,
              0.1564,
              1.0,
              2.0,
              2.6841,
              0.9385,
              2.9622,
              2.9622,
              0.9441,
              0.9441,
              1.0,
              0.9236,
              0.9236,
              0.6364,
              0.6364,
              1.4513,
              1.4513,
              2.0,
              0.2172,
              0.2172,
              0.2257,
              0.2257,
              0.9626,
              0.9626,
              1.0,
              1.0,
              0.0707,
              0.0241,
              0.5608,
              0.5608,
              0.126,
              0.126,
              1.0,
              2.0,
              2.7885,
              0.9522,
              2.9031,
              2.9031,
              0.9605,
              0.9605,
              1.0,
              0.9537,
              0.9537,
              0.6667,
              0.6667,
              1.4306,
              1.4306,
              2.0,
              0.2108,
              0.2108,
              0.2167,
              0.2167,
              0.9728,
              0.9728,
              1.0,
              1.0,
              0.0771,
              0.0272,
              0.5387,
              0.5387,
              0.1431,
              0.1431,
              1.0,
              2.0,
              2.7584,
              0.9728,
              2.8355,
              2.8355,
              0.9728,
              0.9728,
              1.0,
              0.554,
              0.554,
              0.3968,
              0.3968,
              1.3962,
              1.3962,
              2.0,
              0.0833,
              0.0833,
              0.0877,
              0.0877,
              0.9494,
              0.9494,
              1.0,
              1.0,
              0.0361,
              0.1251,
              0.2588,
              0.2588,
              0.1396,
              0.1396,
              1.0,
              2.0,
              1.2934,
              0.8508,
              1.3623,
              1.3623,
              0.9494,
              0.9494,
              1.0,
              0.6765,
              0.9308,
              0.4845,
              0.4845,
              1.3962,
              1.3962,
              2.0,
              0.46,
              0.2057,
              0.4845,
              0.4845,
              0.9494,
              0.9494,
              1.0,
              1.0,
              0.3671,
              0.0265,
              2.6295,
              2.6295,
              0.1396,
              0.1396,
              1.0,
              2.0,
              2.4964,
              0.9494,
              2.6295,
              2.6295,
              0.9494,
              0.9494,
              1.0,
              0.6431,
              0.6431,
              0.6667,
              0.6667,
              0.9646,
              0.9646,
              2.0,
              0.209,
              0.209,
              0.2167,
              0.2167,
              0.9646,
              0.9646,
              1.0,
              1.0,
              0.3075,
              0.1833,
              0.3187,
              0.3187,
              0.9646,
              0.9646,
              1.0,
              2.0,
              27.2727,
              0.9646,
              28.2727,
              28.2727,
              0.9646,
              0.9646
            ]
          }
        },
        {
          "output_type": "stream",
          "execution_count": null,
          "metadata": {},
          "content": {
            "stream_name": "stdout",
            "text": "Station JobClass   QLen   Util  RespT  ResidT   ArvR   Tput\n  Delay   Class1 1.2581 1.2581 0.6687  0.6687 1.3945 1.3945\n  Delay   Class2 0.3111 0.3111 0.2081  0.2081 0.9532 0.9525\n Queue1   Class1 0.2429 0.0274 2.0496  2.0496 0.1288 0.1288\n Queue1   Class2 2.1879 0.9469 2.7398  2.7398 0.9525 0.9504\n",
            "numerical_values": [
              1.0,
              1.2581,
              1.2581,
              0.6687,
              0.6687,
              1.3945,
              1.3945,
              2.0,
              0.3111,
              0.3111,
              0.2081,
              0.2081,
              0.9532,
              0.9525,
              1.0,
              1.0,
              0.2429,
              0.0274,
              2.0496,
              2.0496,
              0.1288,
              0.1288,
              1.0,
              2.0,
              2.1879,
              0.9469,
              2.7398,
              2.7398,
              0.9525,
              0.9504
            ]
          }
        }
      ],
      "execution_count": 3
    }
  },
  "numerical_summary": {
    "cell_2": [
      1.0,
      1.3604,
      1.3604,
      0.6667,
      0.66667,
      2.0406,
      2.0406,
      2.0,
      1.2027e-17,
      1.2027e-17,
      0.2167,
      1.492e-17,
      5.5511e-17,
      5.5511e-17,
      1.0,
      1.0,
      0.63962,
      0.19385,
      0.6269,
      0.31345,
      1.0203,
      1.0203,
      1.0,
      2.0,
      2.0,
      0.80615,
      2.4809,
      2.4809,
      0.80615,
      0.80615,
      1.0,
      1.0808,
      1.0808,
      0.6619,
      0.6619,
      1.4927,
      1.4927,
      2.0,
      0.1959,
      0.1959,
      0.2166,
      0.2166,
      0.9509,
      0.9509,
      1.0,
      1.0,
      0.0847,
      0.0305,
      0.5264,
      0.5264,
      0.1564,
      0.1564,
      1.0,
      2.0,
      2.6841,
      0.9385,
      2.9622,
      2.9622,
      0.9441,
      0.9441,
      1.0,
      0.9236,
      0.9236,
      0.6364,
      0.6364,
      1.4513,
      1.4513,
      2.0,
      0.2172,
      0.2172,
      0.2257,
      0.2257,
      0.9626,
      0.9626,
      1.0,
      1.0,
      0.0707,
      0.0241,
      0.5608,
      0.5608,
      0.126,
      0.126,
      1.0,
      2.0,
      2.7885,
      0.9522,
      2.9031,
      2.9031,
      0.9605,
      0.9605,
      1.0,
      0.9537,
      0.9537,
      0.6667,
      0.6667,
      1.4306,
      1.4306,
      2.0,
      0.2108,
      0.2108,
      0.2167,
      0.2167,
      0.9728,
      0.9728,
      1.0,
      1.0,
      0.0771,
      0.0272,
      0.5387,
      0.5387,
      0.1431,
      0.1431,
      1.0,
      2.0,
      2.7584,
      0.9728,
      2.8355,
      2.8355,
      0.9728,
      0.9728,
      1.0,
      0.554,
      0.554,
      0.3968,
      0.3968,
      1.3962,
      1.3962,
      2.0,
      0.0833,
      0.0833,
      0.0877,
      0.0877,
      0.9494,
      0.9494,
      1.0,
      1.0,
      0.0361,
      0.1251,
      0.2588,
      0.2588,
      0.1396,
      0.1396,
      1.0,
      2.0,
      1.2934,
      0.8508,
      1.3623,
      1.3623,
      0.9494,
      0.9494,
      1.0,
      0.6765,
      0.9308,
      0.4845,
      0.4845,
      1.3962,
      1.3962,
      2.0,
      0.46,
      0.2057,
      0.4845,
      0.4845,
      0.9494,
      0.9494,
      1.0,
      1.0,
      0.3671,
      0.0265,
      2.6295,
      2.6295,
      0.1396,
      0.1396,
      1.0,
      2.0,
      2.4964,
      0.9494,
      2.6295,
      2.6295,
      0.9494,
      0.9494,
      1.0,
      0.6431,
      0.6431,
      0.6667,
      0.6667,
      0.9646,
      0.9646,
      2.0,
      0.209,
      0.209,
      0.2167,
      0.2167,
      0.9646,
      0.9646,
      1.0,
      1.0,
      0.3075,
      0.1833,
      0.3187,
      0.3187,
      0.9646,
      0.9646,
      1.0,
      2.0,
      27.2727,
      0.9646,
      28.2727,
      28.2727,
      0.9646,
      0.9646,
      1.0,
      1.2581,
      1.2581,
      0.6687,
      0.6687,
      1.3945,
      1.3945,
      2.0,
      0.3111,
      0.3111,
      0.2081,
      0.2081,
      0.9532,
      0.9525,
      1.0,
      1.0,
      0.2429,
      0.0274,
      2.0496,
      2.0496,
      0.1288,
      0.1288,
      1.0,
      2.0,
      2.1879,
      0.9469,
      2.7398,
      2.7398,
      0.9525,
      0.9504
    ]
  },
  "metadata": {
    "notebook_path": "closedQN/cqn_twoclass_hyperl.ipynb",
    "source_dir": "examples/basic",
    "total_cells": 3,
    "code_cells": 3,
    "generation_info": {
      "script_version": "2.0",
      "extraction_method": "comprehensive"
    }
  }
}