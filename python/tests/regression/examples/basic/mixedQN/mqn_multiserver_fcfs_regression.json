{
  "cell_content": {
    "cell_0": {
      "cell_type": "code",
      "source": "from line_solver import *\nimport numpy as np\nGlobalConstants.set_verbose(VerboseLevel.STD)",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-30T22:22:05.399281Z",
          "start_time": "2025-07-30T22:22:04.458185Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-01T10:27:20.931377Z",
          "iopub.execute_input": "2026-01-01T10:27:20.931462Z",
          "iopub.status.idle": "2026-01-01T10:27:21.403056Z",
          "shell.execute_reply": "2026-01-01T10:27:21.402799Z"
        }
      },
      "outputs": [],
      "execution_count": 1
    },
    "cell_1": {
      "cell_type": "code",
      "source": "model = Network('model')\n\n# Create 5 multi-server queues with FCFS scheduling\nnode = np.empty(5, dtype=object)\nnode[0] = Queue(model, 'Queue1', SchedStrategy.FCFS)\nnode[0].set_number_of_servers(1)\nnode[1] = Queue(model, 'Queue2', SchedStrategy.FCFS)\nnode[1].set_number_of_servers(2)\nnode[2] = Queue(model, 'Queue3', SchedStrategy.FCFS)\nnode[2].set_number_of_servers(3)\nnode[3] = Queue(model, 'Queue4', SchedStrategy.FCFS)  # only closed classes\nnode[3].set_number_of_servers(4)\nnode[4] = Queue(model, 'Queue5', SchedStrategy.FCFS)  # only open classes\nnode[4].set_number_of_servers(5)\n\nsource = Source(model, 'Source')\nsink = Sink(model, 'Sink')\n\n# Create job classes\njobclass = np.empty(2, dtype=object)\njobclass[0] = ClosedClass(model, 'ClosedClass', 3, node[0], 0)\njobclass[1] = OpenClass(model, 'OpenClass', 0)\n\n# Set service rates\nfor i in range(5):\n    node[i].set_service(jobclass[0], Exp(i+1))\n    node[i].set_service(jobclass[1], Exp(np.sqrt(i+1)))\n\n# Set arrival rate for open class\nsource.set_arrival(jobclass[1], Exp(0.3))",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-30T22:22:05.426856Z",
          "start_time": "2025-07-30T22:22:05.402234Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-01T10:27:21.404113Z",
          "iopub.execute_input": "2026-01-01T10:27:21.404239Z",
          "iopub.status.idle": "2026-01-01T10:27:21.406815Z",
          "shell.execute_reply": "2026-01-01T10:27:21.406596Z"
        }
      },
      "outputs": [],
      "execution_count": 2
    },
    "cell_2": {
      "cell_type": "code",
      "source": "# Setup routing matrix\nM = model.get_number_of_stations()\nK = model.get_number_of_classes()\n\nP = model.init_routing_matrix()\n\n# Closed class routing: Queue1 -> Queue2 -> Queue3 -> Queue4 -> Queue1 (circular)\nP.set(jobclass[0], jobclass[0], node[0], node[1], 1.0)\nP.set(jobclass[0], jobclass[0], node[1], node[2], 1.0)\nP.set(jobclass[0], jobclass[0], node[2], node[3], 1.0)\nP.set(jobclass[0], jobclass[0], node[3], node[0], 1.0)\n\n# Open class routing: Source -> Queue1 -> Queue2 -> Queue3 -> Queue5 -> Sink\nP.set(jobclass[1], jobclass[1], source, node[0], 1.0)\nP.set(jobclass[1], jobclass[1], node[0], node[1], 1.0)\nP.set(jobclass[1], jobclass[1], node[1], node[2], 1.0)\nP.set(jobclass[1], jobclass[1], node[2], node[4], 1.0)\nP.set(jobclass[1], jobclass[1], node[4], sink, 1.0)\n\nmodel.link(P)",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-30T22:22:05.513075Z",
          "start_time": "2025-07-30T22:22:05.504390Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-01T10:27:21.407601Z",
          "iopub.execute_input": "2026-01-01T10:27:21.407692Z",
          "iopub.status.idle": "2026-01-01T10:27:21.409886Z",
          "shell.execute_reply": "2026-01-01T10:27:21.409673Z"
        }
      },
      "outputs": [],
      "execution_count": 3
    },
    "cell_3": {
      "cell_type": "code",
      "source": "print('This example shows the execution of the solver on a 2-class mixed model with 5 multi-server nodes.')\n\n# Create solvers\nsolver = np.array([], dtype=object)\nsolver = np.append(solver, CTMC(model, cutoff=3))  # CTMC is infinite on this model\nsolver = np.append(solver, JMT(model, samples=100000, seed=23000))\nsolver = np.append(solver, SSA(model, cutoff=3, seed=23000))\nsolver = np.append(solver, MVA(model))\n# Note: MAM does not support mixed models with both open and closed classes\nsolver = np.append(solver, DES(model, samples=100000, seed=23000))\n\n# Solve and display results\nAvgTable = np.empty(len(solver), dtype=object)\nfor s in range(len(solver)):\n    print(f'\\nSOLVER: {solver[s].get_name()}')\n    AvgTable[s] = solver[s].avg_table()\n    print(AvgTable[s])",
      "metadata": {
        "jupyter": {
          "is_executing": true
        },
        "ExecuteTime": {
          "start_time": "2025-07-30T22:22:05.548740Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-01T10:27:21.410557Z",
          "iopub.execute_input": "2026-01-01T10:27:21.410631Z",
          "shell.execute_reply": "2026-01-01T10:27:25.396562Z",
          "iopub.status.idle": "2026-01-01T10:27:25.396910Z"
        }
      },
      "outputs": [
        {
          "output_type": "stream",
          "execution_count": null,
          "metadata": {},
          "content": {
            "stream_name": "stdout",
            "text": "This example shows the execution of the solver on a 2-class mixed model with 5 multi-server nodes.\n\nSOLVER: CTMC\n  Station     JobClass    QLen    Util   RespT  ResidT    ArvR    Tput\n0  Queue1  ClosedClass  0.5739  0.3924  1.4626  0.1148  0.3924  0.3924\n1  Queue2  ClosedClass  0.1973  0.0981  0.5028  0.0395  0.3924  0.3924\n2  Queue3  ClosedClass  0.1308  0.0436  0.3333  0.0262  0.3924  0.3924\n3  Queue4  ClosedClass  0.0981  0.0245  0.2500  0.0196  0.3924  0.3924\n4  Queue5  ClosedClass  1.0000  0.2000  0.2000  0.2000  5.0000  5.0000\n5  Source  ClosedClass  1.0000  0.0000  0.0000  0.0000  0.0000  0.0000\n\nSOLVER: JMT\n",
            "numerical_values": [
              2.0,
              5.0,
              0.0,
              1.0,
              0.5739,
              0.3924,
              1.4626,
              0.1148,
              0.3924,
              0.3924,
              1.0,
              2.0,
              0.1973,
              0.0981,
              0.5028,
              0.0395,
              0.3924,
              0.3924,
              2.0,
              3.0,
              0.1308,
              0.0436,
              0.3333,
              0.0262,
              0.3924,
              0.3924,
              3.0,
              4.0,
              0.0981,
              0.0245,
              0.25,
              0.0196,
              0.3924,
              0.3924,
              4.0,
              5.0,
              1.0,
              0.2,
              0.2,
              0.2,
              5.0,
              5.0,
              5.0,
              1.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0
            ]
          }
        },
        {
          "output_type": "stream",
          "execution_count": null,
          "metadata": {},
          "content": {
            "stream_name": "stderr",
            "text": "/home/gcasale/Dropbox/code/line-dev.git/python/line_solver/api_native/solvers/ctmc/handler.py:518: RuntimeWarning: invalid value encountered in scalar multiply\n  TN[ist, k] = UN[ist, k] * c * mu\n",
            "numerical_values": [
              518.0
            ]
          }
        },
        {
          "output_type": "stream",
          "execution_count": null,
          "metadata": {},
          "content": {
            "stream_name": "stdout",
            "text": "   Station     JobClass    QLen    Util   RespT  ResidT    ArvR    Tput\n0   Queue1  ClosedClass  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000\n1   Queue1    OpenClass  1.4247  0.5990  2.4202  2.4202  0.5982  0.5982\n2   Queue2  ClosedClass  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000\n3   Queue2    OpenClass  0.4415  0.2113  0.7358  0.7358  0.6004  0.6004\n4   Queue3  ClosedClass  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000\n5   Queue3    OpenClass  0.3506  0.1166  0.5836  0.5836  0.6003  0.6003\n6   Queue4  ClosedClass  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000\n7   Queue4    OpenClass  0.1505  0.0376  0.5013  0.5013  0.2986  0.2986\n8   Queue5  ClosedClass  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000\n9   Queue5    OpenClass  0.1347  0.0269  0.4467  0.4467  0.2991  0.2991\n10  Source  ClosedClass  0.0000  0.0000  0.0000  0.0000  0.0000  1.0000\n11  Source    OpenClass  0.0000  0.0000  0.0000  0.0000  0.0000  0.3000\n\nSOLVER: SSA\n",
            "numerical_values": [
              0.0,
              1.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              1.0,
              1.0,
              1.4247,
              0.599,
              2.4202,
              2.4202,
              0.5982,
              0.5982,
              2.0,
              2.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              3.0,
              2.0,
              0.4415,
              0.2113,
              0.7358,
              0.7358,
              0.6004,
              0.6004,
              4.0,
              3.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              5.0,
              3.0,
              0.3506,
              0.1166,
              0.5836,
              0.5836,
              0.6003,
              0.6003,
              6.0,
              4.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              7.0,
              4.0,
              0.1505,
              0.0376,
              0.5013,
              0.5013,
              0.2986,
              0.2986,
              8.0,
              5.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              9.0,
              5.0,
              0.1347,
              0.0269,
              0.4467,
              0.4467,
              0.2991,
              0.2991,
              10.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              1.0,
              11.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.3
            ]
          }
        },
        {
          "output_type": "stream",
          "execution_count": null,
          "metadata": {},
          "content": {
            "stream_name": "stdout",
            "text": "  Station     JobClass    QLen    Util   RespT  ResidT    ArvR    Tput\n0  Queue1  ClosedClass  1.9778  0.9225  2.1002  2.1002  0.9417  0.9417\n1  Queue2  ClosedClass  0.4710  0.2308  0.5002  0.5002  0.9417  0.9417\n2  Queue3  ClosedClass  0.3130  0.1043  0.3324  0.3324  0.9417  0.9417\n3  Queue4  ClosedClass  0.2382  0.0596  0.2530  0.2530  0.9417  0.9417\n4  Source  ClosedClass  0.0000  0.0000  0.0000  0.0000  0.0000  1.0000\n5  Source    OpenClass  0.0000  0.0000  0.0000  0.0000  0.0000  0.3000\n\nSOLVER: MVA\n   Station     JobClass    QLen    Util   RespT  ResidT    ArvR    Tput\n0   Queue1  ClosedClass  1.6316  0.5932  2.7505  2.7505  0.5932  0.5932\n1   Queue1    OpenClass  1.1278  0.3000  3.7595  3.7595  0.3000  0.3000\n2   Queue2  ClosedClass  0.3100  0.1483  0.5226  0.5226  0.5932  0.5932\n3   Queue2    OpenClass  0.2254  0.1061  0.7514  0.7514  0.3000  0.3000\n4   Queue3  ClosedClass  0.1980  0.0659  0.3338  0.3338  0.5932  0.5932\n5   Queue3    OpenClass  0.1736  0.0577  0.5786  0.5786  0.3000  0.3000\n6   Queue4  ClosedClass  0.1484  0.0371  0.2502  0.2502  0.5932  0.5932\n7   Queue4    OpenClass  0.1502  0.0375  0.5006  0.5006  0.3000  0.3000\n8   Queue5  ClosedClass  0.1187  0.0237  0.2001  0.2001  0.5932  0.5932\n9   Queue5    OpenClass  0.1343  0.0268  0.4475  0.4475  0.3000  0.3000\n10  Source  ClosedClass  0.0000  0.0000  0.0000  0.0000  0.0000  0.5932\n11  Source    OpenClass  0.0000  0.0000  0.0000  0.0000  0.0000  0.3000\n\nSOLVER: DES\n",
            "numerical_values": [
              0.0,
              1.0,
              1.9778,
              0.9225,
              2.1002,
              2.1002,
              0.9417,
              0.9417,
              1.0,
              2.0,
              0.471,
              0.2308,
              0.5002,
              0.5002,
              0.9417,
              0.9417,
              2.0,
              3.0,
              0.313,
              0.1043,
              0.3324,
              0.3324,
              0.9417,
              0.9417,
              3.0,
              4.0,
              0.2382,
              0.0596,
              0.253,
              0.253,
              0.9417,
              0.9417,
              4.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              1.0,
              5.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.3,
              0.0,
              1.0,
              1.6316,
              0.5932,
              2.7505,
              2.7505,
              0.5932,
              0.5932,
              1.0,
              1.0,
              1.1278,
              0.3,
              3.7595,
              3.7595,
              0.3,
              0.3,
              2.0,
              2.0,
              0.31,
              0.1483,
              0.5226,
              0.5226,
              0.5932,
              0.5932,
              3.0,
              2.0,
              0.2254,
              0.1061,
              0.7514,
              0.7514,
              0.3,
              0.3,
              4.0,
              3.0,
              0.198,
              0.0659,
              0.3338,
              0.3338,
              0.5932,
              0.5932,
              5.0,
              3.0,
              0.1736,
              0.0577,
              0.5786,
              0.5786,
              0.3,
              0.3,
              6.0,
              4.0,
              0.1484,
              0.0371,
              0.2502,
              0.2502,
              0.5932,
              0.5932,
              7.0,
              4.0,
              0.1502,
              0.0375,
              0.5006,
              0.5006,
              0.3,
              0.3,
              8.0,
              5.0,
              0.1187,
              0.0237,
              0.2001,
              0.2001,
              0.5932,
              0.5932,
              9.0,
              5.0,
              0.1343,
              0.0268,
              0.4475,
              0.4475,
              0.3,
              0.3,
              10.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.5932,
              11.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.3
            ]
          }
        },
        {
          "output_type": "stream",
          "execution_count": null,
          "metadata": {},
          "content": {
            "stream_name": "stdout",
            "text": "  Station     JobClass    QLen    Util   RespT  ResidT    ArvR    Tput\n0  Queue1  ClosedClass  2.1961  0.6901  3.2598  3.2598  0.6842  0.6841\n1  Queue1    OpenClass  1.2323  0.2811  4.4293  4.4293  0.2920  0.2918\n2  Queue2  ClosedClass  0.3860  0.1721  0.5397  0.5397  0.6841  0.6841\n3  Queue2    OpenClass  0.2253  0.1035  0.7567  0.7567  0.2918  0.2918\n4  Queue3  ClosedClass  0.2384  0.0760  0.3345  0.3345  0.6841  0.6841\n5  Queue3    OpenClass  0.1716  0.0560  0.5764  0.5764  0.2918  0.2918\n6  Queue4  ClosedClass  0.1795  0.0430  0.2512  0.2512  0.6841  0.6841\n7  Queue5    OpenClass  0.1305  0.0256  0.4379  0.4379  0.2918  0.2918\n8  Source  ClosedClass  0.0000  0.0000  0.0000  0.0000  0.0000  1.0000\n9  Source    OpenClass  0.0000  0.0000  0.0000  0.0000  0.0000  0.3000\n",
            "numerical_values": [
              0.0,
              1.0,
              2.1961,
              0.6901,
              3.2598,
              3.2598,
              0.6842,
              0.6841,
              1.0,
              1.0,
              1.2323,
              0.2811,
              4.4293,
              4.4293,
              0.292,
              0.2918,
              2.0,
              2.0,
              0.386,
              0.1721,
              0.5397,
              0.5397,
              0.6841,
              0.6841,
              3.0,
              2.0,
              0.2253,
              0.1035,
              0.7567,
              0.7567,
              0.2918,
              0.2918,
              4.0,
              3.0,
              0.2384,
              0.076,
              0.3345,
              0.3345,
              0.6841,
              0.6841,
              5.0,
              3.0,
              0.1716,
              0.056,
              0.5764,
              0.5764,
              0.2918,
              0.2918,
              6.0,
              4.0,
              0.1795,
              0.043,
              0.2512,
              0.2512,
              0.6841,
              0.6841,
              7.0,
              5.0,
              0.1305,
              0.0256,
              0.4379,
              0.4379,
              0.2918,
              0.2918,
              8.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              1.0,
              9.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.3
            ]
          }
        }
      ],
      "execution_count": 4
    }
  },
  "numerical_summary": {
    "cell_3": [
      2.0,
      5.0,
      0.0,
      1.0,
      0.5739,
      0.3924,
      1.4626,
      0.1148,
      0.3924,
      0.3924,
      1.0,
      2.0,
      0.1973,
      0.0981,
      0.5028,
      0.0395,
      0.3924,
      0.3924,
      2.0,
      3.0,
      0.1308,
      0.0436,
      0.3333,
      0.0262,
      0.3924,
      0.3924,
      3.0,
      4.0,
      0.0981,
      0.0245,
      0.25,
      0.0196,
      0.3924,
      0.3924,
      4.0,
      5.0,
      1.0,
      0.2,
      0.2,
      0.2,
      5.0,
      5.0,
      5.0,
      1.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      518.0,
      0.0,
      1.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      1.0,
      1.0,
      1.4247,
      0.599,
      2.4202,
      2.4202,
      0.5982,
      0.5982,
      2.0,
      2.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      3.0,
      2.0,
      0.4415,
      0.2113,
      0.7358,
      0.7358,
      0.6004,
      0.6004,
      4.0,
      3.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      5.0,
      3.0,
      0.3506,
      0.1166,
      0.5836,
      0.5836,
      0.6003,
      0.6003,
      6.0,
      4.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      7.0,
      4.0,
      0.1505,
      0.0376,
      0.5013,
      0.5013,
      0.2986,
      0.2986,
      8.0,
      5.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      9.0,
      5.0,
      0.1347,
      0.0269,
      0.4467,
      0.4467,
      0.2991,
      0.2991,
      10.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      1.0,
      11.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.3,
      0.0,
      1.0,
      1.9778,
      0.9225,
      2.1002,
      2.1002,
      0.9417,
      0.9417,
      1.0,
      2.0,
      0.471,
      0.2308,
      0.5002,
      0.5002,
      0.9417,
      0.9417,
      2.0,
      3.0,
      0.313,
      0.1043,
      0.3324,
      0.3324,
      0.9417,
      0.9417,
      3.0,
      4.0,
      0.2382,
      0.0596,
      0.253,
      0.253,
      0.9417,
      0.9417,
      4.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      1.0,
      5.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.3,
      0.0,
      1.0,
      1.6316,
      0.5932,
      2.7505,
      2.7505,
      0.5932,
      0.5932,
      1.0,
      1.0,
      1.1278,
      0.3,
      3.7595,
      3.7595,
      0.3,
      0.3,
      2.0,
      2.0,
      0.31,
      0.1483,
      0.5226,
      0.5226,
      0.5932,
      0.5932,
      3.0,
      2.0,
      0.2254,
      0.1061,
      0.7514,
      0.7514,
      0.3,
      0.3,
      4.0,
      3.0,
      0.198,
      0.0659,
      0.3338,
      0.3338,
      0.5932,
      0.5932,
      5.0,
      3.0,
      0.1736,
      0.0577,
      0.5786,
      0.5786,
      0.3,
      0.3,
      6.0,
      4.0,
      0.1484,
      0.0371,
      0.2502,
      0.2502,
      0.5932,
      0.5932,
      7.0,
      4.0,
      0.1502,
      0.0375,
      0.5006,
      0.5006,
      0.3,
      0.3,
      8.0,
      5.0,
      0.1187,
      0.0237,
      0.2001,
      0.2001,
      0.5932,
      0.5932,
      9.0,
      5.0,
      0.1343,
      0.0268,
      0.4475,
      0.4475,
      0.3,
      0.3,
      10.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.5932,
      11.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.3,
      0.0,
      1.0,
      2.1961,
      0.6901,
      3.2598,
      3.2598,
      0.6842,
      0.6841,
      1.0,
      1.0,
      1.2323,
      0.2811,
      4.4293,
      4.4293,
      0.292,
      0.2918,
      2.0,
      2.0,
      0.386,
      0.1721,
      0.5397,
      0.5397,
      0.6841,
      0.6841,
      3.0,
      2.0,
      0.2253,
      0.1035,
      0.7567,
      0.7567,
      0.2918,
      0.2918,
      4.0,
      3.0,
      0.2384,
      0.076,
      0.3345,
      0.3345,
      0.6841,
      0.6841,
      5.0,
      3.0,
      0.1716,
      0.056,
      0.5764,
      0.5764,
      0.2918,
      0.2918,
      6.0,
      4.0,
      0.1795,
      0.043,
      0.2512,
      0.2512,
      0.6841,
      0.6841,
      7.0,
      5.0,
      0.1305,
      0.0256,
      0.4379,
      0.4379,
      0.2918,
      0.2918,
      8.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      1.0,
      9.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.3,
      2.0,
      5.0,
      3.0,
      100000.0,
      23000.0,
      3.0,
      23000.0,
      100000.0,
      23000.0
    ]
  },
  "metadata": {
    "notebook_path": "mixedQN/mqn_multiserver_fcfs.ipynb",
    "source_dir": "examples/basic",
    "total_cells": 4,
    "code_cells": 4,
    "generation_info": {
      "script_version": "2.0",
      "extraction_method": "comprehensive"
    }
  }
}