{
  "cell_content": {
    "cell_0": {
      "cell_type": "code",
      "source": "from line_solver import *\nGlobalConstants.set_verbose(VerboseLevel.SILENT)\n\n# Clear variables (equivalent to MATLAB's clear P T E A solver AvgTable)\nP = None\nT = None \nE = None\nA = None\nsolver = None\nAvgTable = None",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-30T22:19:04.194866Z",
          "start_time": "2025-07-30T22:19:03.230474Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-03T15:33:10.070596Z",
          "iopub.execute_input": "2026-01-03T15:33:10.070732Z",
          "shell.execute_reply": "2026-01-03T15:33:10.776280Z",
          "iopub.status.idle": "2026-01-03T15:33:10.776918Z"
        }
      },
      "outputs": [],
      "execution_count": 1
    },
    "cell_1": {
      "cell_type": "code",
      "source": "print('This example illustrates the execution on a layered queueing network model.')\nprint('Performance indexes now refer to processors, tasks, entries, and activities.')\nprint('Indexes refer to the submodel (layer) where the processor or task acts as a server.')\nprint('NaN indexes indicate that the metric is not supported by the node type.')\n\n# cwd = os.path.dirname(os.path.abspath(__file__))\n# model = LayeredNetwork.parse_xml(os.path.join(cwd, 'example_layeredModel_1.xml'))\n\n# Create model following MATLAB exactly\nmodel = LayeredNetwork('myLayeredModel')\n\n# MATLAB: P{1} = Processor(model, 'P1', 1, SchedStrategy.PS);\n# MATLAB: P{2} = Processor(model, 'P2', 1, SchedStrategy.PS);\nP = {}\nP[1] = Processor(model, 'P1', 1, SchedStrategy.PS)\nP[2] = Processor(model, 'P2', 1, SchedStrategy.PS)\n\n# MATLAB: T{1} = Task(model, 'T1', 10, SchedStrategy.REF).on(P{1}).set_think_time(Exp.fit_mean(100));\n# MATLAB: T{2} = Task(model, 'T2', 1, SchedStrategy.FCFS).on(P{2}).set_think_time(Immediate());\nT = {}\nT[1] = Task(model, 'T1', 10, SchedStrategy.REF).on(P[1]).set_think_time(Exp.fit_mean(100))\nT[2] = Task(model, 'T2', 1, SchedStrategy.FCFS).on(P[2]).set_think_time(Immediate())\n\n# MATLAB: E{1} = Entry(model, 'E1').on(T{1});\n# MATLAB: E{2} = Entry(model, 'E2').on(T{2});\nE = {}\nE[1] = Entry(model, 'E1').on(T[1])\nE[2] = Entry(model, 'E2').on(T[2])\n\n# MATLAB: A{1} = Activity(model, 'AS1', Exp.fit_mean(1.6)).on(T{1}).boundTo(E{1});\n# MATLAB: A{2} = Activity(model, 'AS2', Immediate()).on(T{1}).synchCall(E{2},1);\n# MATLAB: A{3} = Activity(model, 'AS3', Exp.fit_mean(5)).on(T{2}).boundTo(E{2});\n# MATLAB: A{4} = Activity(model, 'AS4', Exp.fit_mean(1)).on(T{2}).repliesTo(E{2});\nA = {}\nA[1] = Activity(model, 'AS1', Exp.fit_mean(1.6)).on(T[1]).bound_to(E[1])\nA[2] = Activity(model, 'AS2', Immediate()).on(T[1]).synch_call(E[2], 1)\nA[3] = Activity(model, 'AS3', Exp.fit_mean(5)).on(T[2]).bound_to(E[2])\nA[4] = Activity(model, 'AS4', Exp.fit_mean(1)).on(T[2]).replies_to(E[2])\n\n# MATLAB: T{1}.add_precedence(ActivityPrecedence.Serial(A{1}, A{2}));\n# MATLAB: T{2}.add_precedence(ActivityPrecedence.Serial(A{3}, A{4}));\nT[1].add_precedence(ActivityPrecedence.Serial(A[1], A[2]))\nT[2].add_precedence(ActivityPrecedence.Serial(A[3], A[4]))",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-30T22:19:04.271145Z",
          "start_time": "2025-07-30T22:19:04.258602Z"
        },
        "collapsed": false,
        "execution": {
          "iopub.status.busy": "2026-01-03T15:33:10.778610Z",
          "iopub.execute_input": "2026-01-03T15:33:10.778827Z",
          "shell.execute_reply": "2026-01-03T15:33:10.788931Z",
          "iopub.status.idle": "2026-01-03T15:33:10.789319Z"
        }
      },
      "outputs": [
        {
          "output_type": "stream",
          "execution_count": null,
          "metadata": {},
          "content": {
            "stream_name": "stdout",
            "text": "This example illustrates the execution on a layered queueing network model.\nPerformance indexes now refer to processors, tasks, entries, and activities.\nIndexes refer to the submodel (layer) where the processor or task acts as a server.\nNaN indexes indicate that the metric is not supported by the node type.\n"
          }
        },
        {
          "output_type": "execute_result",
          "execution_count": 2,
          "metadata": {},
          "content": {
            "text/plain": "<line_solver.layered.Task at 0x7d494b847750>",
            "numerical_values": [
              0.0,
              7.0,
              494.0,
              847750.0
            ]
          }
        }
      ],
      "execution_count": 2
    },
    "cell_2": {
      "cell_type": "code",
      "source": "# MATLAB: options = LQNS.defaultOptions;\n# MATLAB: options.keep = true; % uncomment to keep the intermediate XML files generates while translating the model to LQNS\noptions = LQNS.default_options()\noptions.keep = True  # uncomment to keep the intermediate XML files generates while translating the model to LQNS\n\n# MATLAB: solver{1} = LQNS(model);\n# MATLAB: AvgTable{1} = solver{1}.avg_table();\n# MATLAB: AvgTable{1}\nsolver = {}\nAvgTable = {}\n\nif LQNS.isAvailable():\n    solver[1] = LQNS(model)\n    AvgTable[1] = solver[1].avg_table()\n    print('AvgTable[1]:')\n    print(AvgTable[1])\nelse:\n    print('LQNS solver not available')\n\n# MATLAB: CallAvgTable = {};\n# MATLAB: [AvgTable{2}, CallAvgTable{2}] = solver{1}.get_raw_avg_tables();\n# MATLAB: AvgTable{2}\n# MATLAB: CallAvgTable{2}\nCallAvgTable = {}\nif LQNS.isAvailable():\n    try:\n        AvgTable[2], CallAvgTable[2] = solver[1].get_raw_avg_tables()\n        print('AvgTable[2]:')\n        print(AvgTable[2])\n        print('CallAvgTable[2]:')\n        print(CallAvgTable[2])\n    except:\n        print('getRawAvgTables method not yet implemented')\n\n# MATLAB: AvgTable{3} = LN(model).get_avg_table\nAvgTable[3] = LN(model).avg_table()\nprint('AvgTable[3]:')\nprint(AvgTable[3])",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-30T22:19:04.533039Z",
          "start_time": "2025-07-30T22:19:04.318788Z"
        },
        "collapsed": false,
        "execution": {
          "iopub.status.busy": "2026-01-03T15:33:10.790414Z",
          "iopub.execute_input": "2026-01-03T15:33:10.790517Z",
          "shell.execute_reply": "2026-01-03T15:33:10.825325Z",
          "iopub.status.idle": "2026-01-03T15:33:10.825758Z"
        }
      },
      "outputs": [
        {
          "output_type": "stream",
          "execution_count": null,
          "metadata": {},
          "content": {
            "stream_name": "stdout",
            "text": "Node   QLen   Util   RespT   Tput\n  P1 0.0000 0.1421  0.0000 0.0000\n  T1 1.1215 0.1421  0.0000 0.0888\n  E1 1.1215 0.1421 12.6310 0.0888\n AS1 0.1627 0.1421  1.8327 0.0888\n AS2 0.9587 0.0000 10.7983 0.0888\n  P2 0.0000 0.5327  0.0000 0.0000\n  T2 0.5327 0.5327  0.0000 0.0888\n  E2 0.5327 0.5327  6.0000 0.0888\n AS3 0.4439 0.4439  5.0000 0.0888\n AS4 0.0888 0.0888  1.0000 0.0888\nAvgTable[1]:\n  Node    QLen    Util    RespT    Tput\n0   P1  0.0000  0.1421   0.0000  0.0000\n1   T1  1.1215  0.1421   0.0000  0.0888\n2   E1  1.1215  0.1421  12.6310  0.0888\n3  AS1  0.1627  0.1421   1.8327  0.0888\n4  AS2  0.9587  0.0000  10.7983  0.0888\n5   P2  0.0000  0.5327   0.0000  0.0000\n6   T2  0.5327  0.5327   0.0000  0.0888\n7   E2  0.5327  0.5327   6.0000  0.0888\n8  AS3  0.4439  0.4439   5.0000  0.0888\n9  AS4  0.0888  0.0888   1.0000  0.0888\nAvgTable[2]:\n  Node    QLen    Util    RespT    Tput\n0   P1  0.0000  0.1421   0.0000  0.0000\n1   T1  1.1215  0.1421   0.0000  0.0888\n2   E1  1.1215  0.1421  12.6310  0.0888\n3  AS1  0.1627  0.1421   1.8327  0.0888\n4  AS2  0.9587  0.0000  10.7983  0.0888\n5   P2  0.0000  0.5327   0.0000  0.0000\n6   T2  0.5327  0.5327   0.0000  0.0888\n7   E2  0.5327  0.5327   6.0000  0.0888\n8  AS3  0.4439  0.4439   5.0000  0.0888\n9  AS4  0.0888  0.0888   1.0000  0.0888\nCallAvgTable[2]:\nEmpty DataFrame\nColumns: [From, To, CallRate, Wait]\nIndex: []\nNode  NodeType   QLen   Util   RespT  ResidT   ArvR   Tput\n  P1 Processor 0.1645 0.1435  1.8331  1.8331 0.0897 0.0897\n  P2 Processor 1.0000 1.0000  5.0000  5.0000 0.2000 0.2000\n  T2      Task 0.8637 0.5000 10.3645 10.3645 0.0833 0.0833\n  E1     Entry 0.1645 0.1435  1.8331  1.8331 0.0897 0.0897\n  E2     Entry 1.0000 1.0000  5.0000  5.0000 0.2000 0.2000\nAvgTable[3]:\n  Node   NodeType    QLen    Util    RespT   ResidT    ArvR    Tput\n0   P1  Processor  0.1645  0.1435   1.8331   1.8331  0.0897  0.0897\n1   P2  Processor  1.0000  1.0000   5.0000   5.0000  0.2000  0.2000\n2   T2       Task  0.8637  0.5000  10.3645  10.3645  0.0833  0.0833\n3   E1      Entry  0.1645  0.1435   1.8331   1.8331  0.0897  0.0897\n4   E2      Entry  1.0000  1.0000   5.0000   5.0000  0.2000  0.2000\n",
            "numerical_values": [
              1.0,
              0.0,
              0.1421,
              0.0,
              0.0,
              1.0,
              1.1215,
              0.1421,
              0.0,
              0.0888,
              1.0,
              1.1215,
              0.1421,
              12.631,
              0.0888,
              1.0,
              0.1627,
              0.1421,
              1.8327,
              0.0888,
              2.0,
              0.9587,
              0.0,
              10.7983,
              0.0888,
              2.0,
              0.0,
              0.5327,
              0.0,
              0.0,
              2.0,
              0.5327,
              0.5327,
              0.0,
              0.0888,
              2.0,
              0.5327,
              0.5327,
              6.0,
              0.0888,
              3.0,
              0.4439,
              0.4439,
              5.0,
              0.0888,
              4.0,
              0.0888,
              0.0888,
              1.0,
              0.0888,
              1.0,
              0.0,
              1.0,
              0.0,
              0.1421,
              0.0,
              0.0,
              1.0,
              1.0,
              1.1215,
              0.1421,
              0.0,
              0.0888,
              2.0,
              1.0,
              1.1215,
              0.1421,
              12.631,
              0.0888,
              3.0,
              1.0,
              0.1627,
              0.1421,
              1.8327,
              0.0888,
              4.0,
              2.0,
              0.9587,
              0.0,
              10.7983,
              0.0888,
              5.0,
              2.0,
              0.0,
              0.5327,
              0.0,
              0.0,
              6.0,
              2.0,
              0.5327,
              0.5327,
              0.0,
              0.0888,
              7.0,
              2.0,
              0.5327,
              0.5327,
              6.0,
              0.0888,
              8.0,
              3.0,
              0.4439,
              0.4439,
              5.0,
              0.0888,
              9.0,
              4.0,
              0.0888,
              0.0888,
              1.0,
              0.0888,
              2.0,
              0.0,
              1.0,
              0.0,
              0.1421,
              0.0,
              0.0,
              1.0,
              1.0,
              1.1215,
              0.1421,
              0.0,
              0.0888,
              2.0,
              1.0,
              1.1215,
              0.1421,
              12.631,
              0.0888,
              3.0,
              1.0,
              0.1627,
              0.1421,
              1.8327,
              0.0888,
              4.0,
              2.0,
              0.9587,
              0.0,
              10.7983,
              0.0888,
              5.0,
              2.0,
              0.0,
              0.5327,
              0.0,
              0.0,
              6.0,
              2.0,
              0.5327,
              0.5327,
              0.0,
              0.0888,
              7.0,
              2.0,
              0.5327,
              0.5327,
              6.0,
              0.0888,
              8.0,
              3.0,
              0.4439,
              0.4439,
              5.0,
              0.0888,
              9.0,
              4.0,
              0.0888,
              0.0888,
              1.0,
              0.0888,
              2.0,
              1.0,
              0.1645,
              0.1435,
              1.8331,
              1.8331,
              0.0897,
              0.0897,
              2.0,
              1.0,
              1.0,
              5.0,
              5.0,
              0.2,
              0.2,
              2.0,
              0.8637,
              0.5,
              10.3645,
              10.3645,
              0.0833,
              0.0833,
              1.0,
              0.1645,
              0.1435,
              1.8331,
              1.8331,
              0.0897,
              0.0897,
              2.0,
              1.0,
              1.0,
              5.0,
              5.0,
              0.2,
              0.2,
              3.0,
              0.0,
              1.0,
              0.1645,
              0.1435,
              1.8331,
              1.8331,
              0.0897,
              0.0897,
              1.0,
              2.0,
              1.0,
              1.0,
              5.0,
              5.0,
              0.2,
              0.2,
              2.0,
              2.0,
              0.8637,
              0.5,
              10.3645,
              10.3645,
              0.0833,
              0.0833,
              3.0,
              1.0,
              0.1645,
              0.1435,
              1.8331,
              1.8331,
              0.0897,
              0.0897,
              4.0,
              2.0,
              1.0,
              1.0,
              5.0,
              5.0,
              0.2,
              0.2
            ]
          }
        }
      ],
      "execution_count": 3
    }
  },
  "numerical_summary": {
    "cell_1": [
      0.0,
      7.0,
      494.0,
      847750.0
    ],
    "cell_2": [
      1.0,
      0.0,
      0.1421,
      0.0,
      0.0,
      1.0,
      1.1215,
      0.1421,
      0.0,
      0.0888,
      1.0,
      1.1215,
      0.1421,
      12.631,
      0.0888,
      1.0,
      0.1627,
      0.1421,
      1.8327,
      0.0888,
      2.0,
      0.9587,
      0.0,
      10.7983,
      0.0888,
      2.0,
      0.0,
      0.5327,
      0.0,
      0.0,
      2.0,
      0.5327,
      0.5327,
      0.0,
      0.0888,
      2.0,
      0.5327,
      0.5327,
      6.0,
      0.0888,
      3.0,
      0.4439,
      0.4439,
      5.0,
      0.0888,
      4.0,
      0.0888,
      0.0888,
      1.0,
      0.0888,
      1.0,
      0.0,
      1.0,
      0.0,
      0.1421,
      0.0,
      0.0,
      1.0,
      1.0,
      1.1215,
      0.1421,
      0.0,
      0.0888,
      2.0,
      1.0,
      1.1215,
      0.1421,
      12.631,
      0.0888,
      3.0,
      1.0,
      0.1627,
      0.1421,
      1.8327,
      0.0888,
      4.0,
      2.0,
      0.9587,
      0.0,
      10.7983,
      0.0888,
      5.0,
      2.0,
      0.0,
      0.5327,
      0.0,
      0.0,
      6.0,
      2.0,
      0.5327,
      0.5327,
      0.0,
      0.0888,
      7.0,
      2.0,
      0.5327,
      0.5327,
      6.0,
      0.0888,
      8.0,
      3.0,
      0.4439,
      0.4439,
      5.0,
      0.0888,
      9.0,
      4.0,
      0.0888,
      0.0888,
      1.0,
      0.0888,
      2.0,
      0.0,
      1.0,
      0.0,
      0.1421,
      0.0,
      0.0,
      1.0,
      1.0,
      1.1215,
      0.1421,
      0.0,
      0.0888,
      2.0,
      1.0,
      1.1215,
      0.1421,
      12.631,
      0.0888,
      3.0,
      1.0,
      0.1627,
      0.1421,
      1.8327,
      0.0888,
      4.0,
      2.0,
      0.9587,
      0.0,
      10.7983,
      0.0888,
      5.0,
      2.0,
      0.0,
      0.5327,
      0.0,
      0.0,
      6.0,
      2.0,
      0.5327,
      0.5327,
      0.0,
      0.0888,
      7.0,
      2.0,
      0.5327,
      0.5327,
      6.0,
      0.0888,
      8.0,
      3.0,
      0.4439,
      0.4439,
      5.0,
      0.0888,
      9.0,
      4.0,
      0.0888,
      0.0888,
      1.0,
      0.0888,
      2.0,
      1.0,
      0.1645,
      0.1435,
      1.8331,
      1.8331,
      0.0897,
      0.0897,
      2.0,
      1.0,
      1.0,
      5.0,
      5.0,
      0.2,
      0.2,
      2.0,
      0.8637,
      0.5,
      10.3645,
      10.3645,
      0.0833,
      0.0833,
      1.0,
      0.1645,
      0.1435,
      1.8331,
      1.8331,
      0.0897,
      0.0897,
      2.0,
      1.0,
      1.0,
      5.0,
      5.0,
      0.2,
      0.2,
      3.0,
      0.0,
      1.0,
      0.1645,
      0.1435,
      1.8331,
      1.8331,
      0.0897,
      0.0897,
      1.0,
      2.0,
      1.0,
      1.0,
      5.0,
      5.0,
      0.2,
      0.2,
      2.0,
      2.0,
      0.8637,
      0.5,
      10.3645,
      10.3645,
      0.0833,
      0.0833,
      3.0,
      1.0,
      0.1645,
      0.1435,
      1.8331,
      1.8331,
      0.0897,
      0.0897,
      4.0,
      2.0,
      1.0,
      1.0,
      5.0,
      5.0,
      0.2,
      0.2
    ]
  },
  "metadata": {
    "notebook_path": "layeredModel/lqn_serial.ipynb",
    "source_dir": "examples/basic",
    "total_cells": 3,
    "code_cells": 3,
    "generation_info": {
      "script_version": "2.0",
      "extraction_method": "comprehensive"
    }
  }
}