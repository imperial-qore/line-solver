{
  "cell_content": {
    "cell_0": {
      "cell_type": "code",
      "source": "from line_solver import *\nimport numpy as np\nGlobalConstants.set_verbose(VerboseLevel.SILENT)",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-30T22:18:47.178779Z",
          "start_time": "2025-07-30T22:18:46.302647Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-03T15:33:13.513458Z",
          "iopub.execute_input": "2026-01-03T15:33:13.513593Z",
          "shell.execute_reply": "2026-01-03T15:33:14.268404Z",
          "iopub.status.idle": "2026-01-03T15:33:14.268986Z"
        }
      },
      "outputs": [],
      "execution_count": 1
    },
    "cell_1": {
      "cell_type": "code",
      "source": "print('This example illustrates a layered network with a loop.')\n\nmodel = LayeredNetwork('myLayeredModel')\n\n# Layer 1 - Reference task\nP1 = Processor(model, 'P1', GlobalConstants.MaxInt, SchedStrategy.INF)\nT1 = Task(model, 'T1', 1, SchedStrategy.REF).on(P1)\nT1.set_think_time(Immediate())\nE1 = Entry(model, 'Entry').on(T1)\n\n# Layer 2 - Service task\nP2 = Processor(model, 'P2', GlobalConstants.MaxInt, SchedStrategy.INF)\nT2 = Task(model, 'T2', 1, SchedStrategy.INF).on(P2).set_think_time(Immediate())\nE2 = Entry(model, 'E2').on(T2)\n\n# Layer 3 - Backend task\nP3 = Processor(model, 'P3', 5, SchedStrategy.PS)\nT3 = Task(model, 'T3', 20, SchedStrategy.INF).on(P3)\nT3.set_think_time(Exp.fit_mean(10))\nE3 = Entry(model, 'E1').on(T3)  # Note: Entry named 'E1' in original\n\n# Activities for T1 (with loop)\nA1 = Activity(model, 'A1', Exp.fit_mean(1)).on(T1).bound_to(E1)\nA2 = Activity(model, 'A2', Exp.fit_mean(2)).on(T1)\nA3 = Activity(model, 'A3', Exp.fit_mean(3)).on(T1).synch_call(E2, 1)\n\n# Activities for T2 (with fork-join)\nB1 = Activity(model, 'B1', Exp.fit_mean(0.1)).on(T2).bound_to(E2)\nB2 = Activity(model, 'B2', Exp.fit_mean(0.2)).on(T2)\nB3 = Activity(model, 'B3', Exp.fit_mean(0.3)).on(T2)\nB4 = Activity(model, 'B4', Exp.fit_mean(0.4)).on(T2)\nB5 = Activity(model, 'B5', Exp.fit_mean(0.5)).on(T2)\nB6 = Activity(model, 'B6', Exp.fit_mean(0.6)).on(T2).synch_call(E3, 1).replies_to(E2)\n\n# Activities for T3 (with or-fork/join)\nC1 = Activity(model, 'C1', Exp.fit_mean(0.1)).on(T3).bound_to(E3)\nC2 = Activity(model, 'C2', Exp.fit_mean(0.2)).on(T3)\nC3 = Activity(model, 'C3', Exp.fit_mean(0.3)).on(T3)\nC4 = Activity(model, 'C4', Exp.fit_mean(0.4)).on(T3)\nC5 = Activity(model, 'C5', Exp.fit_mean(0.5)).on(T3).replies_to(E3)",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-30T22:18:47.245299Z",
          "start_time": "2025-07-30T22:18:47.230010Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-03T15:33:14.270529Z",
          "iopub.execute_input": "2026-01-03T15:33:14.270745Z",
          "shell.execute_reply": "2026-01-03T15:33:14.274758Z",
          "iopub.status.idle": "2026-01-03T15:33:14.275092Z"
        }
      },
      "outputs": [
        {
          "output_type": "stream",
          "execution_count": null,
          "metadata": {},
          "content": {
            "stream_name": "stdout",
            "text": "This example illustrates a layered network with a loop.\n"
          }
        }
      ],
      "execution_count": 2
    },
    "cell_2": {
      "cell_type": "code",
      "source": "# Add precedence relationships\n\n# T1: Loop with 3 iterations\nT1.add_precedence(ActivityPrecedence.Loop(A1, [A2, A3], 3))\n\n# T2: Serial connection and AND fork-join\nT2.add_precedence(ActivityPrecedence.Serial(B4, B5))\nT2.add_precedence(ActivityPrecedence.AndFork(B1, [B2, B3, B4]))\nT2.add_precedence(ActivityPrecedence.AndJoin([B2, B3, B5], B6))\n\n# T3: OR fork-join with probabilities\nT3.add_precedence(ActivityPrecedence.OrFork(C1, [C2, C3, C4], [0.3, 0.3, 0.4]))\nT3.add_precedence(ActivityPrecedence.OrJoin([C2, C3, C4], C5))",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-30T22:18:47.309815Z",
          "start_time": "2025-07-30T22:18:47.282769Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-03T15:33:14.275967Z",
          "iopub.execute_input": "2026-01-03T15:33:14.276071Z",
          "shell.execute_reply": "2026-01-03T15:33:14.279655Z",
          "iopub.status.idle": "2026-01-03T15:33:14.279969Z"
        }
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "execution_count": 3,
          "metadata": {},
          "content": {
            "text/plain": "<line_solver.layered.Task at 0x71b41dd27b10>",
            "numerical_values": [
              0.0,
              71.0,
              41.0,
              27.0,
              10.0
            ]
          }
        }
      ],
      "execution_count": 3
    },
    "cell_3": {
      "cell_type": "code",
      "source": "# Solve with different solvers\n\nif LQNS.isAvailable():\n    solver_lqns = LQNS(model)\n    avg_table_lqns = solver_lqns.avg_table()",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-30T22:18:47.452237Z",
          "start_time": "2025-07-30T22:18:47.345032Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-03T15:33:14.280808Z",
          "iopub.execute_input": "2026-01-03T15:33:14.280906Z",
          "shell.execute_reply": "2026-01-03T15:33:14.301346Z",
          "iopub.status.idle": "2026-01-03T15:33:14.301782Z"
        }
      },
      "outputs": [
        {
          "output_type": "stream",
          "execution_count": null,
          "metadata": {},
          "content": {
            "stream_name": "stdout",
            "text": " Node   QLen   Util   RespT   Tput\n   P1 0.0000 0.7958  0.0000 0.0000\n   T1 1.0000 0.7958  0.0000 0.0796\nEntry 1.0000 0.7958 12.5667 0.0796\n   A1 0.0796 0.0796  1.0000 0.0796\n   A2 0.4775 0.4775  2.0000 0.2387\n   A3 0.4430 0.2387  5.5667 0.0796\n   P2 0.0000 0.1671  0.0000 0.0000\n   T2 0.2042 0.1671  0.0000 0.0796\n   E2 0.2042 0.1671  2.5667 0.0796\n   B1 0.0080 0.0080  0.1000 0.0796\n   B2 0.0159 0.0159  0.2000 0.0796\n   B3 0.0239 0.0239  0.3000 0.0796\n   B4 0.0318 0.0318  0.4000 0.0796\n   B5 0.0398 0.0398  0.5000 0.0796\n   B6 0.1201 0.0477  1.5098 0.0796\n   P3 0.0000 0.0724  0.0000 0.0000\n   T3 0.0724 0.0724  0.0000 0.0796\n   E1 0.0724 0.0724  0.9098 0.0796\n   C1 0.0080 0.0080  0.1000 0.0796\n   C2 0.0048 0.0048  0.2000 0.0239\n   C3 0.0072 0.0072  0.2999 0.0239\n   C4 0.0127 0.0127  0.3999 0.0318\n   C5 0.0398 0.0398  0.4999 0.0796\n",
            "numerical_values": [
              1.0,
              0.0,
              0.7958,
              0.0,
              0.0,
              1.0,
              1.0,
              0.7958,
              0.0,
              0.0796,
              1.0,
              0.7958,
              12.5667,
              0.0796,
              1.0,
              0.0796,
              0.0796,
              1.0,
              0.0796,
              2.0,
              0.4775,
              0.4775,
              2.0,
              0.2387,
              3.0,
              0.443,
              0.2387,
              5.5667,
              0.0796,
              2.0,
              0.0,
              0.1671,
              0.0,
              0.0,
              2.0,
              0.2042,
              0.1671,
              0.0,
              0.0796,
              2.0,
              0.2042,
              0.1671,
              2.5667,
              0.0796,
              1.0,
              0.008,
              0.008,
              0.1,
              0.0796,
              2.0,
              0.0159,
              0.0159,
              0.2,
              0.0796,
              3.0,
              0.0239,
              0.0239,
              0.3,
              0.0796,
              4.0,
              0.0318,
              0.0318,
              0.4,
              0.0796,
              5.0,
              0.0398,
              0.0398,
              0.5,
              0.0796,
              6.0,
              0.1201,
              0.0477,
              1.5098,
              0.0796,
              3.0,
              0.0,
              0.0724,
              0.0,
              0.0,
              3.0,
              0.0724,
              0.0724,
              0.0,
              0.0796,
              1.0,
              0.0724,
              0.0724,
              0.9098,
              0.0796,
              1.0,
              0.008,
              0.008,
              0.1,
              0.0796,
              2.0,
              0.0048,
              0.0048,
              0.2,
              0.0239,
              3.0,
              0.0072,
              0.0072,
              0.2999,
              0.0239,
              4.0,
              0.0127,
              0.0127,
              0.3999,
              0.0318,
              5.0,
              0.0398,
              0.0398,
              0.4999,
              0.0796
            ]
          }
        }
      ],
      "execution_count": 4
    },
    "cell_4": {
      "cell_type": "code",
      "source": "solver_ln = LN(model)\navg_table_ln = solver_ln.avg_table()",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-30T22:18:51.877340Z",
          "start_time": "2025-07-30T22:18:47.460550Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-03T15:33:14.303005Z",
          "iopub.execute_input": "2026-01-03T15:33:14.303122Z",
          "shell.execute_reply": "2026-01-03T15:33:14.310007Z",
          "iopub.status.idle": "2026-01-03T15:33:14.310427Z"
        }
      },
      "outputs": [
        {
          "output_type": "stream",
          "execution_count": null,
          "metadata": {},
          "content": {
            "stream_name": "stdout",
            "text": " Node  NodeType   QLen       Util        RespT       ResidT       ArvR       Tput\n   P1 Processor 1.0000 1.0000e-06 1000000.0000 1000000.0000 1.0000e-06 1.0000e-06\n   P2 Processor 0.9997 9.9973e-07  100000.0000  100000.0000 9.9973e-06 9.9973e-06\n   P3 Processor 1.1458 1.8854e-01       0.6077       0.6077 1.8854e+00 1.8854e+00\n   T2      Task 0.5236 5.2356e-01       2.1000       2.1000 2.4931e-01 2.4931e-01\n   T3      Task 0.5236 2.6178e-02      30.0000      30.0000 1.7452e-02 1.7452e-02\nEntry     Entry 1.0000 1.0000e-06 1000000.0000 1000000.0000 1.0000e-06 1.0000e-06\n   E2     Entry 0.9997 9.9973e-07  100000.0000  100000.0000 9.9973e-06 9.9973e-06\n   E1     Entry 1.1458 1.8854e-01       0.6077       0.6077 1.8854e+00 1.8854e+00\n",
            "numerical_values": [
              1.0,
              1.0,
              1e-06,
              1000000.0,
              1000000.0,
              1e-06,
              1e-06,
              2.0,
              0.9997,
              9.9973e-07,
              100000.0,
              100000.0,
              9.9973e-06,
              9.9973e-06,
              3.0,
              1.1458,
              0.18854,
              0.6077,
              0.6077,
              1.8854,
              1.8854,
              2.0,
              0.5236,
              0.52356,
              2.1,
              2.1,
              0.24931,
              0.24931,
              3.0,
              0.5236,
              0.026178,
              30.0,
              30.0,
              0.017452,
              0.017452,
              1.0,
              1e-06,
              1000000.0,
              1000000.0,
              1e-06,
              1e-06,
              2.0,
              0.9997,
              9.9973e-07,
              100000.0,
              100000.0,
              9.9973e-06,
              9.9973e-06,
              1.0,
              1.1458,
              0.18854,
              0.6077,
              0.6077,
              1.8854,
              1.8854
            ]
          }
        }
      ],
      "execution_count": 5
    }
  },
  "numerical_summary": {
    "cell_2": [
      0.0,
      71.0,
      41.0,
      27.0,
      10.0
    ],
    "cell_3": [
      1.0,
      0.0,
      0.7958,
      0.0,
      0.0,
      1.0,
      1.0,
      0.7958,
      0.0,
      0.0796,
      1.0,
      0.7958,
      12.5667,
      0.0796,
      1.0,
      0.0796,
      0.0796,
      1.0,
      0.0796,
      2.0,
      0.4775,
      0.4775,
      2.0,
      0.2387,
      3.0,
      0.443,
      0.2387,
      5.5667,
      0.0796,
      2.0,
      0.0,
      0.1671,
      0.0,
      0.0,
      2.0,
      0.2042,
      0.1671,
      0.0,
      0.0796,
      2.0,
      0.2042,
      0.1671,
      2.5667,
      0.0796,
      1.0,
      0.008,
      0.008,
      0.1,
      0.0796,
      2.0,
      0.0159,
      0.0159,
      0.2,
      0.0796,
      3.0,
      0.0239,
      0.0239,
      0.3,
      0.0796,
      4.0,
      0.0318,
      0.0318,
      0.4,
      0.0796,
      5.0,
      0.0398,
      0.0398,
      0.5,
      0.0796,
      6.0,
      0.1201,
      0.0477,
      1.5098,
      0.0796,
      3.0,
      0.0,
      0.0724,
      0.0,
      0.0,
      3.0,
      0.0724,
      0.0724,
      0.0,
      0.0796,
      1.0,
      0.0724,
      0.0724,
      0.9098,
      0.0796,
      1.0,
      0.008,
      0.008,
      0.1,
      0.0796,
      2.0,
      0.0048,
      0.0048,
      0.2,
      0.0239,
      3.0,
      0.0072,
      0.0072,
      0.2999,
      0.0239,
      4.0,
      0.0127,
      0.0127,
      0.3999,
      0.0318,
      5.0,
      0.0398,
      0.0398,
      0.4999,
      0.0796
    ],
    "cell_4": [
      1.0,
      1.0,
      1e-06,
      1000000.0,
      1000000.0,
      1e-06,
      1e-06,
      2.0,
      0.9997,
      9.9973e-07,
      100000.0,
      100000.0,
      9.9973e-06,
      9.9973e-06,
      3.0,
      1.1458,
      0.18854,
      0.6077,
      0.6077,
      1.8854,
      1.8854,
      2.0,
      0.5236,
      0.52356,
      2.1,
      2.1,
      0.24931,
      0.24931,
      3.0,
      0.5236,
      0.026178,
      30.0,
      30.0,
      0.017452,
      0.017452,
      1.0,
      1e-06,
      1000000.0,
      1000000.0,
      1e-06,
      1e-06,
      2.0,
      0.9997,
      9.9973e-07,
      100000.0,
      100000.0,
      9.9973e-06,
      9.9973e-06,
      1.0,
      1.1458,
      0.18854,
      0.6077,
      0.6077,
      1.8854,
      1.8854
    ]
  },
  "metadata": {
    "notebook_path": "layeredModel/lqn_workflows.ipynb",
    "source_dir": "examples/basic",
    "total_cells": 5,
    "code_cells": 5,
    "generation_info": {
      "script_version": "2.0",
      "extraction_method": "comprehensive"
    }
  }
}