{
  "cell_content": {
    "cell_0": {
      "cell_type": "code",
      "source": "from line_solver import *\nGlobalConstants.set_verbose(VerboseLevel.STD)",
      "metadata": {
        "collapsed": false,
        "ExecuteTime": {
          "end_time": "2025-07-15T22:49:58.542685Z",
          "start_time": "2025-07-15T22:49:58.527020Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-01T10:32:05.670428Z",
          "iopub.execute_input": "2026-01-01T10:32:05.670510Z",
          "iopub.status.idle": "2026-01-01T10:32:06.127498Z",
          "shell.execute_reply": "2026-01-01T10:32:06.127040Z"
        }
      },
      "outputs": [],
      "execution_count": 1
    },
    "cell_1": {
      "cell_type": "code",
      "source": "model = Network('model')\n\nnode = np.empty(3, dtype=object)\nnode[0] = Delay(model, 'Delay')\nnode[1] = Queue(model, 'Queue1', SchedStrategy.PS)\nnode[2] = Queue(model, 'Queue2', SchedStrategy.FCFS)\n\njobclass = np.empty(2, dtype=object)\njobclass[0] = ClosedClass(model, 'Class1', 1, node[0], 0)\njobclass[1] = ClosedClass(model, 'Class2', 2, node[0], 0)\n\n# renewal\nmap21 = APH([1,0],[[-2,2],[0,-0.5]])\nmap22 = MAP([-1],[1]) \n# non-renewal\nmap31 = MAP([[-20,0],[0,-1]],[[0,20],[0.8,0.2]])\nmap32 = MAP([[-20,0],[0,-1]],[[0,20],[0.8,0.2]])\n\nnode[0].set_service(jobclass[0], HyperExp.fit_mean_and_scv(1.0,25.0))\nnode[1].set_service(jobclass[0], map21)\nnode[2].set_service(jobclass[0], map31)\n\nnode[0].set_service(jobclass[1], HyperExp.fit_mean_and_scv(1.0,25.0))\nnode[1].set_service(jobclass[1], map22)\nnode[2].set_service(jobclass[1], map32)\n\nmodel.add_link(node[0], node[0])\nmodel.add_link(node[0], node[1])\nmodel.add_link(node[0], node[2])\nmodel.add_link(node[1], node[0])\nmodel.add_link(node[2], node[0])\n\nnode[0].set_routing(jobclass[0],RoutingStrategy.RROBIN) # if changed to RAND the EJML exception goes\nnode[1].set_prob_routing(jobclass[0], node[0], 1.0)\nnode[2].set_prob_routing(jobclass[0], node[0], 1.0)\n\nnode[0].set_routing(jobclass[1],RoutingStrategy.RROBIN) # if changed to RAND the EJML exception goes\nnode[1].set_prob_routing(jobclass[1], node[0], 1.0)\nnode[2].set_prob_routing(jobclass[1], node[0], 1.0)",
      "metadata": {
        "collapsed": false,
        "ExecuteTime": {
          "end_time": "2025-07-15T22:49:58.846684Z",
          "start_time": "2025-07-15T22:49:58.737946Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-01T10:32:06.128684Z",
          "iopub.execute_input": "2026-01-01T10:32:06.128819Z",
          "shell.execute_reply": "2026-01-01T10:32:06.132540Z",
          "iopub.status.idle": "2026-01-01T10:32:06.132765Z"
        }
      },
      "outputs": [],
      "execution_count": 2
    },
    "cell_2": {
      "cell_type": "code",
      "source": "solver = np.array([], dtype=object)\nsolver = np.append(solver, JMT(model, seed=23000))\nsolver = np.append(solver, CTMC(model, keep=False))",
      "metadata": {
        "collapsed": false,
        "ExecuteTime": {
          "end_time": "2025-07-15T22:50:44.705459Z",
          "start_time": "2025-07-15T22:50:44.488195Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-01T10:32:06.133482Z",
          "iopub.execute_input": "2026-01-01T10:32:06.133557Z",
          "shell.execute_reply": "2026-01-01T10:32:06.174172Z",
          "iopub.status.idle": "2026-01-01T10:32:06.174536Z"
        }
      },
      "outputs": [],
      "execution_count": 3
    },
    "cell_3": {
      "cell_type": "code",
      "source": "AvgTable = np.empty(len(solver), dtype=object)\nfor s in range(len(solver)):\n    print(f'\\nSOLVER: {solver[s].get_name()}')\n    try:\n        AvgTable[s] = solver[s].avg_table()\n        print(AvgTable[s])\n    except Exception as e:\n        print(f\"Solver error: {type(e).__name__} - Non-FCFS MAP stations may not be supported\")",
      "metadata": {
        "collapsed": false,
        "ExecuteTime": {
          "end_time": "2025-07-15T22:50:54.387421Z",
          "start_time": "2025-07-15T22:50:45.985125Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-01T10:32:06.175639Z",
          "iopub.execute_input": "2026-01-01T10:32:06.175734Z",
          "shell.execute_reply": "2026-01-01T10:32:06.460036Z",
          "iopub.status.idle": "2026-01-01T10:32:06.460287Z"
        }
      },
      "outputs": [
        {
          "output_type": "stream",
          "execution_count": null,
          "metadata": {},
          "content": {
            "stream_name": "stdout",
            "text": "\nSOLVER: JMT\n"
          }
        },
        {
          "output_type": "stream",
          "execution_count": null,
          "metadata": {},
          "content": {
            "stream_name": "stdout",
            "text": "  Station JobClass  QLen  Util  RespT  ResidT  ArvR  Tput\n0   Delay   Class1   0.0   0.0    0.0     0.0   0.0   0.0\n1   Delay   Class2   0.0   0.0    0.0     0.0   0.0   0.0\n2  Queue1   Class1   0.0   0.0    0.0     0.0   0.0   0.0\n3  Queue1   Class2   0.0   0.0    0.0     0.0   0.0   0.0\n4  Queue2   Class1   0.0   0.0    0.0     0.0   0.0   0.0\n5  Queue2   Class2   0.0   0.0    0.0     0.0   0.0   0.0\n\nSOLVER: CTMC\n  Station JobClass    QLen    Util   RespT  ResidT    ArvR    Tput\n0   Delay   Class1  0.1430  0.0000  0.0000  0.0000  0.0000  0.0000\n1   Delay   Class2  0.4447  0.0000  0.0000  0.0000  0.0000  0.0000\n2  Queue1   Class1  0.6220  0.3574  4.3503  4.3503  0.1430  0.1430\n3  Queue1   Class2  0.8951  0.4447  2.0130  2.0130  0.4447  0.4447\n4  Queue2   Class1  0.2351  0.1377  1.6441  1.6441  0.1430  0.1430\n5  Queue2   Class2  0.6602  0.4284  1.4848  1.4848  0.4447  0.4447\n",
            "numerical_values": [
              0.0,
              1.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              1.0,
              2.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              2.0,
              1.0,
              1.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              3.0,
              1.0,
              2.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              4.0,
              2.0,
              1.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              5.0,
              2.0,
              2.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              1.0,
              0.143,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              1.0,
              2.0,
              0.4447,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              2.0,
              1.0,
              1.0,
              0.622,
              0.3574,
              4.3503,
              4.3503,
              0.143,
              0.143,
              3.0,
              1.0,
              2.0,
              0.8951,
              0.4447,
              2.013,
              2.013,
              0.4447,
              0.4447,
              4.0,
              2.0,
              1.0,
              0.2351,
              0.1377,
              1.6441,
              1.6441,
              0.143,
              0.143,
              5.0,
              2.0,
              2.0,
              0.6602,
              0.4284,
              1.4848,
              1.4848,
              0.4447,
              0.4447
            ]
          }
        },
        {
          "output_type": "stream",
          "execution_count": null,
          "metadata": {},
          "content": {
            "stream_name": "stderr",
            "text": "/home/gcasale/Dropbox/code/line-dev.git/python/line_solver/api_native/solvers/ctmc/handler.py:518: RuntimeWarning: invalid value encountered in scalar multiply\n  TN[ist, k] = UN[ist, k] * c * mu\n",
            "numerical_values": [
              518.0
            ]
          }
        }
      ],
      "execution_count": 4
    }
  },
  "numerical_summary": {
    "cell_2": [
      23000.0
    ],
    "cell_3": [
      0.0,
      1.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      1.0,
      2.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      2.0,
      1.0,
      1.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      3.0,
      1.0,
      2.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      4.0,
      2.0,
      1.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      5.0,
      2.0,
      2.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      1.0,
      0.143,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      1.0,
      2.0,
      0.4447,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      2.0,
      1.0,
      1.0,
      0.622,
      0.3574,
      4.3503,
      4.3503,
      0.143,
      0.143,
      3.0,
      1.0,
      2.0,
      0.8951,
      0.4447,
      2.013,
      2.013,
      0.4447,
      0.4447,
      4.0,
      2.0,
      1.0,
      0.2351,
      0.1377,
      1.6441,
      1.6441,
      0.143,
      0.143,
      5.0,
      2.0,
      2.0,
      0.6602,
      0.4284,
      1.4848,
      1.4848,
      0.4447,
      0.4447,
      518.0
    ]
  },
  "metadata": {
    "notebook_path": "stateDepRouting/sdroute_twoclasses_closed.ipynb",
    "source_dir": "examples/advanced",
    "total_cells": 4,
    "code_cells": 4,
    "generation_info": {
      "script_version": "2.0",
      "extraction_method": "comprehensive"
    }
  }
}