{
  "cell_content": {
    "cell_0": {
      "cell_type": "markdown",
      "source": "# Basic Example: Cache with LRU Replacement\n\nThis example demonstrates a cache model with LRU (Least Recently Used) replacement:\n- **Cache**: Stores m items from a universe of n items\n- **Replacement**: LRU eviction policy\n- **Access pattern**: Uniform distribution over items\n- **Closed model**: Single job circulating between delay and cache\n\nThe model tracks hit and miss rates for the cache.",
      "metadata": {},
      "outputs": [],
      "execution_count": null
    },
    "cell_1": {
      "cell_type": "code",
      "source": "from line_solver import *\nGlobalConstants.set_verbose(VerboseLevel.STD)",
      "metadata": {
        "execution": {
          "iopub.status.busy": "2026-01-02T14:07:52.656995Z",
          "iopub.execute_input": "2026-01-02T14:07:52.657094Z",
          "shell.execute_reply": "2026-01-02T14:07:53.442334Z",
          "iopub.status.idle": "2026-01-02T14:07:53.442794Z"
        }
      },
      "outputs": [],
      "execution_count": 1
    },
    "cell_2": {
      "cell_type": "code",
      "source": "def cache_replc_lru(n=5, m=2):\n    \"\"\"\n    Create a cache model with LRU replacement.\n    \n    Args:\n        n: Number of items in the universe\n        m: Cache capacity (number of items that can be stored)\n    \"\"\"\n    model = Network('model')\n    \n    # Block 1: nodes\n    delay = Delay(model, 'Delay')\n    cache_node = Cache(model, 'Cache', n, m, ReplacementStrategy.LRU)\n    \n    # Block 2: classes\n    job_class = ClosedClass(model, 'JobClass', 1, delay, 0)\n    hit_class = ClosedClass(model, 'HitClass', 0, delay, 0)\n    miss_class = ClosedClass(model, 'MissClass', 0, delay, 0)\n    \n    # Set service time at delay node\n    delay.set_service(job_class, Exp(1))\n    \n    # Set cache access pattern (uniform over items)\n    p_access = DiscreteSampler([1/n] * n)\n    cache_node.set_read(job_class, p_access)\n    \n    # Set hit and miss classes\n    cache_node.set_hit_class(job_class, hit_class)\n    cache_node.set_miss_class(job_class, miss_class)\n    \n    # Block 3: topology\n    P = model.init_routing_matrix()\n    P.add_route(job_class, delay, cache_node, 1.0)\n    P.add_class_switch(hit_class, job_class, cache_node, delay, 1.0)\n    P.add_class_switch(miss_class, job_class, cache_node, delay, 1.0)\n    model.link(P)\n    \n    return model\n\n# Create the model\nmodel = cache_replc_lru(n=5, m=2)",
      "metadata": {
        "execution": {
          "iopub.status.busy": "2026-01-02T14:07:53.444097Z",
          "iopub.execute_input": "2026-01-02T14:07:53.444306Z",
          "shell.execute_reply": "2026-01-02T14:07:53.506460Z",
          "iopub.status.idle": "2026-01-02T14:07:53.506785Z"
        }
      },
      "outputs": [],
      "execution_count": 2
    },
    "cell_3": {
      "cell_type": "markdown",
      "source": "## About LRU Caching\n\n**LRU (Least Recently Used)** replacement:\n- When the cache is full and a miss occurs, evict the least recently accessed item\n- Exploits temporal locality in access patterns\n- Commonly used in CPU caches, web caches, databases\n\n**Model parameters**:\n- n=5 items in universe\n- m=2 cache capacity\n- Uniform access probability: each item has 1/5 = 0.2 chance of being accessed\n\nWith uniform access and LRU, the expected hit rate depends on the cache-to-item ratio.",
      "metadata": {},
      "outputs": [],
      "execution_count": null
    },
    "cell_4": {
      "cell_type": "code",
      "source": "# Solve with multiple solvers\nprint(\"\\n=== Solver Results ===\")\n\n# CTMC Solver\nsolver_ctmc = CTMC(model, keep=False)\navg_node_table_ctmc = solver_ctmc.avg_node_table()\nprint(\"\\nCTMC Solver:\")\nprint(avg_node_table_ctmc)\n\n# MVA Solver\nmodel.reset()\nsolver_mva = MVA(model)\navg_node_table_mva = solver_mva.avg_node_table()\nprint(\"\\nMVA Solver:\")\nprint(avg_node_table_mva)",
      "metadata": {
        "execution": {
          "iopub.status.busy": "2026-01-02T14:07:53.508028Z",
          "iopub.execute_input": "2026-01-02T14:07:53.508245Z",
          "iopub.status.idle": "2026-01-02T14:07:53.685360Z",
          "shell.execute_reply": "2026-01-02T14:07:53.685094Z"
        }
      },
      "outputs": [
        {
          "output_type": "stream",
          "execution_count": null,
          "metadata": {},
          "content": {
            "stream_name": "stdout",
            "text": "\n=== Solver Results ===\n                Node   JobClass  QLen  Util  RespT  ResidT  ArvR  Tput\n0              Delay   JobClass   1.0   1.0    1.0     1.0   1.0   1.0\n3              Cache   JobClass   0.0   0.0    0.0     0.0   1.0   0.0\n4              Cache   HitClass   0.0   0.0    0.0     0.0   0.0   0.4\n5              Cache  MissClass   0.0   0.0    0.0     0.0   0.0   0.6\n6  CS_Cache_to_Delay   JobClass   0.0   0.0    0.0     0.0   0.0   1.0\n7  CS_Cache_to_Delay   HitClass   0.0   0.0    0.0     0.0   0.4   0.0\n8  CS_Cache_to_Delay  MissClass   0.0   0.0    0.0     0.0   0.6   0.0\n\nCTMC Solver:\n                Node   JobClass  QLen  Util  RespT  ResidT  ArvR  Tput\n0              Delay   JobClass   1.0   1.0    1.0     1.0   1.0   1.0\n3              Cache   JobClass   0.0   0.0    0.0     0.0   1.0   0.0\n4              Cache   HitClass   0.0   0.0    0.0     0.0   0.0   0.4\n5              Cache  MissClass   0.0   0.0    0.0     0.0   0.0   0.6\n6  CS_Cache_to_Delay   JobClass   0.0   0.0    0.0     0.0   0.0   1.0\n7  CS_Cache_to_Delay   HitClass   0.0   0.0    0.0     0.0   0.4   0.0\n8  CS_Cache_to_Delay  MissClass   0.0   0.0    0.0     0.0   0.6   0.0\n                Node   JobClass  QLen  Util  RespT  ResidT  ArvR  Tput\n0              Delay   JobClass   1.0   1.0    1.0     1.0   1.0   1.0\n3              Cache   JobClass   0.0   0.0    0.0     0.0   1.0   0.0\n4              Cache   HitClass   0.0   0.0    0.0     0.0   0.0   0.4\n5              Cache  MissClass   0.0   0.0    0.0     0.0   0.0   0.6\n6  CS_Cache_to_Delay   JobClass   0.0   0.0    0.0     0.0   0.0   1.0\n7  CS_Cache_to_Delay   HitClass   0.0   0.0    0.0     0.0   0.4   0.0\n8  CS_Cache_to_Delay  MissClass   0.0   0.0    0.0     0.0   0.6   0.0\n\nMVA Solver:\n                Node   JobClass  QLen  Util  RespT  ResidT  ArvR  Tput\n0              Delay   JobClass   1.0   1.0    1.0     1.0   1.0   1.0\n3              Cache   JobClass   0.0   0.0    0.0     0.0   1.0   0.0\n4              Cache   HitClass   0.0   0.0    0.0     0.0   0.0   0.4\n5              Cache  MissClass   0.0   0.0    0.0     0.0   0.0   0.6\n6  CS_Cache_to_Delay   JobClass   0.0   0.0    0.0     0.0   0.0   1.0\n7  CS_Cache_to_Delay   HitClass   0.0   0.0    0.0     0.0   0.4   0.0\n8  CS_Cache_to_Delay  MissClass   0.0   0.0    0.0     0.0   0.6   0.0\n",
            "numerical_values": [
              0.0,
              1.0,
              1.0,
              1.0,
              1.0,
              1.0,
              1.0,
              3.0,
              0.0,
              0.0,
              0.0,
              0.0,
              1.0,
              0.0,
              4.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.4,
              5.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.6,
              6.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              1.0,
              7.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.4,
              0.0,
              8.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.6,
              0.0,
              0.0,
              1.0,
              1.0,
              1.0,
              1.0,
              1.0,
              1.0,
              3.0,
              0.0,
              0.0,
              0.0,
              0.0,
              1.0,
              0.0,
              4.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.4,
              5.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.6,
              6.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              1.0,
              7.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.4,
              0.0,
              8.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.6,
              0.0,
              0.0,
              1.0,
              1.0,
              1.0,
              1.0,
              1.0,
              1.0,
              3.0,
              0.0,
              0.0,
              0.0,
              0.0,
              1.0,
              0.0,
              4.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.4,
              5.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.6,
              6.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              1.0,
              7.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.4,
              0.0,
              8.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.6,
              0.0,
              0.0,
              1.0,
              1.0,
              1.0,
              1.0,
              1.0,
              1.0,
              3.0,
              0.0,
              0.0,
              0.0,
              0.0,
              1.0,
              0.0,
              4.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.4,
              5.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.6,
              6.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.0,
              1.0,
              7.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.4,
              0.0,
              8.0,
              0.0,
              0.0,
              0.0,
              0.0,
              0.6,
              0.0
            ]
          }
        }
      ],
      "execution_count": 3
    }
  },
  "numerical_summary": {
    "cell_3": [
      5.0,
      2.0,
      1.0,
      5.0,
      0.2
    ],
    "cell_4": [
      0.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      3.0,
      0.0,
      0.0,
      0.0,
      0.0,
      1.0,
      0.0,
      4.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.4,
      5.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.6,
      6.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      1.0,
      7.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.4,
      0.0,
      8.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.6,
      0.0,
      0.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      3.0,
      0.0,
      0.0,
      0.0,
      0.0,
      1.0,
      0.0,
      4.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.4,
      5.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.6,
      6.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      1.0,
      7.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.4,
      0.0,
      8.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.6,
      0.0,
      0.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      3.0,
      0.0,
      0.0,
      0.0,
      0.0,
      1.0,
      0.0,
      4.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.4,
      5.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.6,
      6.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      1.0,
      7.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.4,
      0.0,
      8.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.6,
      0.0,
      0.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      3.0,
      0.0,
      0.0,
      0.0,
      0.0,
      1.0,
      0.0,
      4.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.4,
      5.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.6,
      6.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      1.0,
      7.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.4,
      0.0,
      8.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.6,
      0.0
    ]
  },
  "metadata": {
    "notebook_path": "cacheModel/cache_replc_lru.ipynb",
    "source_dir": "examples/basic",
    "total_cells": 5,
    "code_cells": 3,
    "generation_info": {
      "script_version": "2.0",
      "extraction_method": "comprehensive"
    }
  }
}