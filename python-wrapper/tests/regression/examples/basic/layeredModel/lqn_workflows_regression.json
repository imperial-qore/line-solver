{
  "cell_content": {
    "cell_0": {
      "cell_type": "code",
      "source": "from line_solver import *\nimport numpy as np\nGlobalConstants.set_verbose(VerboseLevel.SILENT)",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-30T22:18:47.178779Z",
          "start_time": "2025-07-30T22:18:46.302647Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-02T14:10:14.954836Z",
          "iopub.execute_input": "2026-01-02T14:10:14.954919Z",
          "iopub.status.idle": "2026-01-02T14:10:15.783509Z",
          "shell.execute_reply": "2026-01-02T14:10:15.783179Z"
        }
      },
      "outputs": [],
      "execution_count": 1
    },
    "cell_1": {
      "cell_type": "code",
      "source": "print('This example illustrates a layered network with a loop.')\n\nmodel = LayeredNetwork('myLayeredModel')\n\n# Layer 1 - Reference task\nP1 = Processor(model, 'P1', GlobalConstants.MaxInt, SchedStrategy.INF)\nT1 = Task(model, 'T1', 1, SchedStrategy.REF).on(P1)\nT1.set_think_time(Immediate())\nE1 = Entry(model, 'Entry').on(T1)\n\n# Layer 2 - Service task\nP2 = Processor(model, 'P2', GlobalConstants.MaxInt, SchedStrategy.INF)\nT2 = Task(model, 'T2', 1, SchedStrategy.INF).on(P2).set_think_time(Immediate())\nE2 = Entry(model, 'E2').on(T2)\n\n# Layer 3 - Backend task\nP3 = Processor(model, 'P3', 5, SchedStrategy.PS)\nT3 = Task(model, 'T3', 20, SchedStrategy.INF).on(P3)\nT3.set_think_time(Exp.fit_mean(10))\nE3 = Entry(model, 'E1').on(T3)  # Note: Entry named 'E1' in original\n\n# Activities for T1 (with loop)\nA1 = Activity(model, 'A1', Exp.fit_mean(1)).on(T1).bound_to(E1)\nA2 = Activity(model, 'A2', Exp.fit_mean(2)).on(T1)\nA3 = Activity(model, 'A3', Exp.fit_mean(3)).on(T1).synch_call(E2, 1)\n\n# Activities for T2 (with fork-join)\nB1 = Activity(model, 'B1', Exp.fit_mean(0.1)).on(T2).bound_to(E2)\nB2 = Activity(model, 'B2', Exp.fit_mean(0.2)).on(T2)\nB3 = Activity(model, 'B3', Exp.fit_mean(0.3)).on(T2)\nB4 = Activity(model, 'B4', Exp.fit_mean(0.4)).on(T2)\nB5 = Activity(model, 'B5', Exp.fit_mean(0.5)).on(T2)\nB6 = Activity(model, 'B6', Exp.fit_mean(0.6)).on(T2).synch_call(E3, 1).replies_to(E2)\n\n# Activities for T3 (with or-fork/join)\nC1 = Activity(model, 'C1', Exp.fit_mean(0.1)).on(T3).bound_to(E3)\nC2 = Activity(model, 'C2', Exp.fit_mean(0.2)).on(T3)\nC3 = Activity(model, 'C3', Exp.fit_mean(0.3)).on(T3)\nC4 = Activity(model, 'C4', Exp.fit_mean(0.4)).on(T3)\nC5 = Activity(model, 'C5', Exp.fit_mean(0.5)).on(T3).replies_to(E3)",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-30T22:18:47.245299Z",
          "start_time": "2025-07-30T22:18:47.230010Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-02T14:10:15.784660Z",
          "iopub.execute_input": "2026-01-02T14:10:15.784829Z",
          "shell.execute_reply": "2026-01-02T14:10:15.796909Z",
          "iopub.status.idle": "2026-01-02T14:10:15.797219Z"
        }
      },
      "outputs": [
        {
          "output_type": "stream",
          "execution_count": null,
          "metadata": {},
          "content": {
            "stream_name": "stdout",
            "text": "This example illustrates a layered network with a loop.\n"
          }
        }
      ],
      "execution_count": 2
    },
    "cell_2": {
      "cell_type": "code",
      "source": "# Add precedence relationships\n\n# T1: Loop with 3 iterations\nT1.add_precedence(ActivityPrecedence.Loop(A1, [A2, A3], 3))\n\n# T2: Serial connection and AND fork-join\nT2.add_precedence(ActivityPrecedence.Serial(B4, B5))\nT2.add_precedence(ActivityPrecedence.AndFork(B1, [B2, B3, B4]))\nT2.add_precedence(ActivityPrecedence.AndJoin([B2, B3, B5], B6))\n\n# T3: OR fork-join with probabilities\nT3.add_precedence(ActivityPrecedence.OrFork(C1, [C2, C3, C4], [0.3, 0.3, 0.4]))\nT3.add_precedence(ActivityPrecedence.OrJoin([C2, C3, C4], C5))",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-30T22:18:47.309815Z",
          "start_time": "2025-07-30T22:18:47.282769Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-02T14:10:15.798201Z",
          "iopub.execute_input": "2026-01-02T14:10:15.798315Z",
          "iopub.status.idle": "2026-01-02T14:10:15.819992Z",
          "shell.execute_reply": "2026-01-02T14:10:15.819480Z"
        }
      },
      "outputs": [],
      "execution_count": 3
    },
    "cell_3": {
      "cell_type": "code",
      "source": "# Solve with different solvers\n\nif LQNS.isAvailable():\n    solver_lqns = LQNS(model)\n    avg_table_lqns = solver_lqns.avg_table()",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-30T22:18:47.452237Z",
          "start_time": "2025-07-30T22:18:47.345032Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-02T14:10:15.821889Z",
          "iopub.execute_input": "2026-01-02T14:10:15.822210Z",
          "shell.execute_reply": "2026-01-02T14:10:15.992422Z",
          "iopub.status.idle": "2026-01-02T14:10:15.992709Z"
        }
      },
      "outputs": [
        {
          "output_type": "stream",
          "execution_count": null,
          "metadata": {},
          "content": {
            "stream_name": "stdout",
            "text": "     Node   NodeType    QLen    Util    RespT  ResidT  ArvR    Tput\n0      P1  Processor     NaN  0.7958      NaN     0.0   0.0     NaN\n1      P2  Processor     NaN  0.1671      NaN     0.0   0.0     NaN\n2      P3  Processor     NaN  0.0724      NaN     0.0   0.0     NaN\n3      T1    RefTask  1.0000  0.7958      NaN     0.0   0.0  0.0796\n4      T2       Task  0.2042  0.1671      NaN     0.0   0.0  0.0796\n5      T3       Task  0.0724  0.0724      NaN     0.0   0.0  0.0796\n6   Entry      Entry  1.0000  0.7958  12.5667     0.0   0.0  0.0796\n7      E2      Entry  0.2042  0.1671   2.5667     0.0   0.0  0.0796\n8      E1      Entry  0.0724  0.0724   0.9098     0.0   0.0  0.0796\n9      A1   Activity  0.0796  0.0796   1.0000     0.0   0.0  0.0796\n10     A2   Activity  0.4775  0.4775   2.0000     0.0   0.0  0.2387\n11     A3   Activity  0.4430  0.2387   5.5667     0.0   0.0  0.0796\n12     B1   Activity  0.0080  0.0080   0.1000     0.0   0.0  0.0796\n13     B2   Activity  0.0159  0.0159   0.2000     0.0   0.0  0.0796\n14     B3   Activity  0.0239  0.0239   0.3000     0.0   0.0  0.0796\n15     B4   Activity  0.0318  0.0318   0.4000     0.0   0.0  0.0796\n16     B5   Activity  0.0398  0.0398   0.5000     0.0   0.0  0.0796\n17     B6   Activity  0.1201  0.0477   1.5098     0.0   0.0  0.0796\n18     C1   Activity  0.0080  0.0080   0.1000     0.0   0.0  0.0796\n19     C2   Activity  0.0048  0.0048   0.2000     0.0   0.0  0.0239\n20     C3   Activity  0.0072  0.0072   0.2999     0.0   0.0  0.0239\n21     C4   Activity  0.0127  0.0127   0.3999     0.0   0.0  0.0318\n22     C5   Activity  0.0398  0.0398   0.4999     0.0   0.0  0.0796",
            "numerical_values": [
              0.0,
              1.0,
              0.7958,
              0.0,
              0.0,
              1.0,
              2.0,
              0.1671,
              0.0,
              0.0,
              2.0,
              3.0,
              0.0724,
              0.0,
              0.0,
              3.0,
              1.0,
              1.0,
              0.7958,
              0.0,
              0.0,
              0.0796,
              4.0,
              2.0,
              0.2042,
              0.1671,
              0.0,
              0.0,
              0.0796,
              5.0,
              3.0,
              0.0724,
              0.0724,
              0.0,
              0.0,
              0.0796,
              6.0,
              1.0,
              0.7958,
              12.5667,
              0.0,
              0.0,
              0.0796,
              7.0,
              2.0,
              0.2042,
              0.1671,
              2.5667,
              0.0,
              0.0,
              0.0796,
              8.0,
              1.0,
              0.0724,
              0.0724,
              0.9098,
              0.0,
              0.0,
              0.0796,
              9.0,
              1.0,
              0.0796,
              0.0796,
              1.0,
              0.0,
              0.0,
              0.0796,
              10.0,
              2.0,
              0.4775,
              0.4775,
              2.0,
              0.0,
              0.0,
              0.2387,
              11.0,
              3.0,
              0.443,
              0.2387,
              5.5667,
              0.0,
              0.0,
              0.0796,
              12.0,
              1.0,
              0.008,
              0.008,
              0.1,
              0.0,
              0.0,
              0.0796,
              13.0,
              2.0,
              0.0159,
              0.0159,
              0.2,
              0.0,
              0.0,
              0.0796,
              14.0,
              3.0,
              0.0239,
              0.0239,
              0.3,
              0.0,
              0.0,
              0.0796,
              15.0,
              4.0,
              0.0318,
              0.0318,
              0.4,
              0.0,
              0.0,
              0.0796,
              16.0,
              5.0,
              0.0398,
              0.0398,
              0.5,
              0.0,
              0.0,
              0.0796,
              17.0,
              6.0,
              0.1201,
              0.0477,
              1.5098,
              0.0,
              0.0,
              0.0796,
              18.0,
              1.0,
              0.008,
              0.008,
              0.1,
              0.0,
              0.0,
              0.0796,
              19.0,
              2.0,
              0.0048,
              0.0048,
              0.2,
              0.0,
              0.0,
              0.0239,
              20.0,
              3.0,
              0.0072,
              0.0072,
              0.2999,
              0.0,
              0.0,
              0.0239,
              21.0,
              4.0,
              0.0127,
              0.0127,
              0.3999,
              0.0,
              0.0,
              0.0318,
              22.0,
              5.0,
              0.0398,
              0.0398,
              0.4999,
              0.0,
              0.0,
              0.0796
            ]
          }
        },
        {
          "output_type": "stream",
          "execution_count": null,
          "metadata": {},
          "content": {
            "stream_name": "stdout",
            "text": "\n"
          }
        }
      ],
      "execution_count": 4
    },
    "cell_4": {
      "cell_type": "code",
      "source": "solver_ln = LN(model)\navg_table_ln = solver_ln.avg_table()",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-30T22:18:51.877340Z",
          "start_time": "2025-07-30T22:18:47.460550Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-02T14:10:15.993689Z",
          "iopub.execute_input": "2026-01-02T14:10:15.993843Z",
          "iopub.status.idle": "2026-01-02T14:10:24.348495Z",
          "shell.execute_reply": "2026-01-02T14:10:24.348193Z"
        }
      },
      "outputs": [
        {
          "output_type": "stream",
          "execution_count": null,
          "metadata": {},
          "content": {
            "stream_name": "stdout",
            "text": "     Node   NodeType    QLen    Util    RespT   ResidT  ArvR    Tput\n0      P1  Processor     NaN  0.8280      NaN      NaN   NaN     NaN\n1      P2  Processor     NaN  0.1665      NaN      NaN   NaN     NaN\n2      P3  Processor     NaN  0.0241      NaN      NaN   NaN     NaN\n3      T1       Task  1.0000  0.8280      NaN  10.0000   NaN  0.0828\n4      T2       Task  0.1647  0.1665      NaN   1.1667   NaN  0.0793\n5      T3       Task  0.0722  0.0241      NaN   0.9100   NaN  0.0793\n6   Entry      Entry  1.0000     NaN  12.0767      NaN   NaN  0.0828\n7      E2      Entry  0.1647     NaN   2.0767      NaN   NaN  0.0793\n8      E1      Entry  0.0722     NaN   0.9100      NaN   NaN  0.0793\n9      A1   Activity  0.0828  0.0828   1.0000   1.0000   NaN  0.0828\n10     A2   Activity  0.4968  0.4968   2.0000   6.0000   NaN  0.2484\n11     A3   Activity  0.4204  0.2484   5.0767   3.0000   NaN  0.0828\n12     B1   Activity  0.0079  0.0079   0.1000   0.1000   NaN  0.0793\n13     B2   Activity  0.0159  0.0159   0.2000   0.0667   NaN  0.0793\n14     B3   Activity  0.0238  0.0238   0.3000   0.1000   NaN  0.0793\n15     B4   Activity  0.0317  0.0317   0.4000   0.1333   NaN  0.0793\n16     B5   Activity  0.0396  0.0396   0.5000   0.1667   NaN  0.0793\n17     B6   Activity  0.1198  0.0476   1.5100   0.6000   NaN  0.0793\n18     C1   Activity  0.0079  0.0026   0.1000   0.1000   NaN  0.0793\n19     C2   Activity  0.0048  0.0016   0.2000   0.0600   NaN  0.0238\n20     C3   Activity  0.0071  0.0024   0.3000   0.0900   NaN  0.0238\n21     C4   Activity  0.0127  0.0042   0.4000   0.1600   NaN  0.0317\n22     C5   Activity  0.0397  0.0132   0.5000   0.5000   NaN  0.0793\n",
            "numerical_values": [
              0.0,
              1.0,
              0.828,
              1.0,
              2.0,
              0.1665,
              2.0,
              3.0,
              0.0241,
              3.0,
              1.0,
              1.0,
              0.828,
              10.0,
              0.0828,
              4.0,
              2.0,
              0.1647,
              0.1665,
              1.1667,
              0.0793,
              5.0,
              3.0,
              0.0722,
              0.0241,
              0.91,
              0.0793,
              6.0,
              1.0,
              12.0767,
              0.0828,
              7.0,
              2.0,
              0.1647,
              2.0767,
              0.0793,
              8.0,
              1.0,
              0.0722,
              0.91,
              0.0793,
              9.0,
              1.0,
              0.0828,
              0.0828,
              1.0,
              1.0,
              0.0828,
              10.0,
              2.0,
              0.4968,
              0.4968,
              2.0,
              6.0,
              0.2484,
              11.0,
              3.0,
              0.4204,
              0.2484,
              5.0767,
              3.0,
              0.0828,
              12.0,
              1.0,
              0.0079,
              0.0079,
              0.1,
              0.1,
              0.0793,
              13.0,
              2.0,
              0.0159,
              0.0159,
              0.2,
              0.0667,
              0.0793,
              14.0,
              3.0,
              0.0238,
              0.0238,
              0.3,
              0.1,
              0.0793,
              15.0,
              4.0,
              0.0317,
              0.0317,
              0.4,
              0.1333,
              0.0793,
              16.0,
              5.0,
              0.0396,
              0.0396,
              0.5,
              0.1667,
              0.0793,
              17.0,
              6.0,
              0.1198,
              0.0476,
              1.51,
              0.6,
              0.0793,
              18.0,
              1.0,
              0.0079,
              0.0026,
              0.1,
              0.1,
              0.0793,
              19.0,
              2.0,
              0.0048,
              0.0016,
              0.2,
              0.06,
              0.0238,
              20.0,
              3.0,
              0.0071,
              0.0024,
              0.3,
              0.09,
              0.0238,
              21.0,
              4.0,
              0.0127,
              0.0042,
              0.4,
              0.16,
              0.0317,
              22.0,
              5.0,
              0.0397,
              0.0132,
              0.5,
              0.5,
              0.0793
            ]
          }
        }
      ],
      "execution_count": 5
    }
  },
  "numerical_summary": {
    "cell_3": [
      0.0,
      1.0,
      0.7958,
      0.0,
      0.0,
      1.0,
      2.0,
      0.1671,
      0.0,
      0.0,
      2.0,
      3.0,
      0.0724,
      0.0,
      0.0,
      3.0,
      1.0,
      1.0,
      0.7958,
      0.0,
      0.0,
      0.0796,
      4.0,
      2.0,
      0.2042,
      0.1671,
      0.0,
      0.0,
      0.0796,
      5.0,
      3.0,
      0.0724,
      0.0724,
      0.0,
      0.0,
      0.0796,
      6.0,
      1.0,
      0.7958,
      12.5667,
      0.0,
      0.0,
      0.0796,
      7.0,
      2.0,
      0.2042,
      0.1671,
      2.5667,
      0.0,
      0.0,
      0.0796,
      8.0,
      1.0,
      0.0724,
      0.0724,
      0.9098,
      0.0,
      0.0,
      0.0796,
      9.0,
      1.0,
      0.0796,
      0.0796,
      1.0,
      0.0,
      0.0,
      0.0796,
      10.0,
      2.0,
      0.4775,
      0.4775,
      2.0,
      0.0,
      0.0,
      0.2387,
      11.0,
      3.0,
      0.443,
      0.2387,
      5.5667,
      0.0,
      0.0,
      0.0796,
      12.0,
      1.0,
      0.008,
      0.008,
      0.1,
      0.0,
      0.0,
      0.0796,
      13.0,
      2.0,
      0.0159,
      0.0159,
      0.2,
      0.0,
      0.0,
      0.0796,
      14.0,
      3.0,
      0.0239,
      0.0239,
      0.3,
      0.0,
      0.0,
      0.0796,
      15.0,
      4.0,
      0.0318,
      0.0318,
      0.4,
      0.0,
      0.0,
      0.0796,
      16.0,
      5.0,
      0.0398,
      0.0398,
      0.5,
      0.0,
      0.0,
      0.0796,
      17.0,
      6.0,
      0.1201,
      0.0477,
      1.5098,
      0.0,
      0.0,
      0.0796,
      18.0,
      1.0,
      0.008,
      0.008,
      0.1,
      0.0,
      0.0,
      0.0796,
      19.0,
      2.0,
      0.0048,
      0.0048,
      0.2,
      0.0,
      0.0,
      0.0239,
      20.0,
      3.0,
      0.0072,
      0.0072,
      0.2999,
      0.0,
      0.0,
      0.0239,
      21.0,
      4.0,
      0.0127,
      0.0127,
      0.3999,
      0.0,
      0.0,
      0.0318,
      22.0,
      5.0,
      0.0398,
      0.0398,
      0.4999,
      0.0,
      0.0,
      0.0796
    ],
    "cell_4": [
      0.0,
      1.0,
      0.828,
      1.0,
      2.0,
      0.1665,
      2.0,
      3.0,
      0.0241,
      3.0,
      1.0,
      1.0,
      0.828,
      10.0,
      0.0828,
      4.0,
      2.0,
      0.1647,
      0.1665,
      1.1667,
      0.0793,
      5.0,
      3.0,
      0.0722,
      0.0241,
      0.91,
      0.0793,
      6.0,
      1.0,
      12.0767,
      0.0828,
      7.0,
      2.0,
      0.1647,
      2.0767,
      0.0793,
      8.0,
      1.0,
      0.0722,
      0.91,
      0.0793,
      9.0,
      1.0,
      0.0828,
      0.0828,
      1.0,
      1.0,
      0.0828,
      10.0,
      2.0,
      0.4968,
      0.4968,
      2.0,
      6.0,
      0.2484,
      11.0,
      3.0,
      0.4204,
      0.2484,
      5.0767,
      3.0,
      0.0828,
      12.0,
      1.0,
      0.0079,
      0.0079,
      0.1,
      0.1,
      0.0793,
      13.0,
      2.0,
      0.0159,
      0.0159,
      0.2,
      0.0667,
      0.0793,
      14.0,
      3.0,
      0.0238,
      0.0238,
      0.3,
      0.1,
      0.0793,
      15.0,
      4.0,
      0.0317,
      0.0317,
      0.4,
      0.1333,
      0.0793,
      16.0,
      5.0,
      0.0396,
      0.0396,
      0.5,
      0.1667,
      0.0793,
      17.0,
      6.0,
      0.1198,
      0.0476,
      1.51,
      0.6,
      0.0793,
      18.0,
      1.0,
      0.0079,
      0.0026,
      0.1,
      0.1,
      0.0793,
      19.0,
      2.0,
      0.0048,
      0.0016,
      0.2,
      0.06,
      0.0238,
      20.0,
      3.0,
      0.0071,
      0.0024,
      0.3,
      0.09,
      0.0238,
      21.0,
      4.0,
      0.0127,
      0.0042,
      0.4,
      0.16,
      0.0317,
      22.0,
      5.0,
      0.0397,
      0.0132,
      0.5,
      0.5,
      0.0793
    ]
  },
  "metadata": {
    "notebook_path": "layeredModel/lqn_workflows.ipynb",
    "source_dir": "examples/basic",
    "total_cells": 5,
    "code_cells": 5,
    "generation_info": {
      "script_version": "2.0",
      "extraction_method": "comprehensive"
    }
  }
}