{
  "cell_content": {
    "cell_0": {
      "cell_type": "code",
      "source": "from line_solver import *\nimport numpy as np\nGlobalConstants.set_verbose(VerboseLevel.STD)",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-30T22:13:51.911293Z",
          "start_time": "2025-07-30T22:13:50.969919Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-02T14:08:50.928609Z",
          "iopub.execute_input": "2026-01-02T14:08:50.928754Z",
          "shell.execute_reply": "2026-01-02T14:08:51.839212Z",
          "iopub.status.idle": "2026-01-02T14:08:51.839649Z"
        }
      },
      "outputs": [],
      "execution_count": 1
    },
    "cell_1": {
      "cell_type": "code",
      "source": "model = Network('model')\n# Create models\nnode = np.empty(4, dtype = object)\nnode[0] = ClassSwitch(model, 'CS', [[0, 1], [1, 0]])\nnode[1] = Queue(model, 'Queue1', SchedStrategy.PS)\nnode[2] = Queue(model, 'Queue2', SchedStrategy.PS)\nnode[3] = Queue(model, 'Delay', SchedStrategy.INF)\n\n# Create job classes\njobclass = np.empty(2, dtype = object)\njobclass[0] = ClosedClass(model, 'Class1', 15, node[3], 0)\njobclass[1] = ClosedClass(model, 'Class2', 5, node[3], 0)\n\n# Set service times\nnode[1].set_service(jobclass[0], Exp.fit_mean(1.5))  #mean = 1.5\nnode[1].set_service(jobclass[1], Erlang.fit_mean_and_order(1.5, 2))  #mean = 1.5\n\nnode[2].set_service(jobclass[0], Erlang.fit_mean_and_order(1.5, 2))  #mean = 1.5\nnode[2].set_service(jobclass[1], Exp.fit_mean(1.5))  #mean = 1.5\n\nnode[3].set_service(jobclass[0], Exp.fit_mean(1.0))  #mean = 1\nnode[3].set_service(jobclass[1], Exp.fit_mean(1.0))  #mean = 1\n\n# Add links\nmodel.add_link(node[1], node[0])\nmodel.add_link(node[2], node[0])\nmodel.add_link(node[0], node[3])\nmodel.add_link(node[3], node[1])\nmodel.add_link(node[3], node[2])\n\n# Set routing strategies\nnode[0].set_routing(jobclass[0], RoutingStrategy.RAND)\nnode[1].set_routing(jobclass[0], RoutingStrategy.RAND)\nnode[2].set_routing(jobclass[0], RoutingStrategy.RAND)\nnode[3].set_routing(jobclass[0], RoutingStrategy.RROBIN)\n\nnode[0].set_routing(jobclass[1], RoutingStrategy.RAND)\nnode[1].set_routing(jobclass[1], RoutingStrategy.RAND)\nnode[2].set_routing(jobclass[1], RoutingStrategy.RAND)\nnode[3].set_routing(jobclass[1], RoutingStrategy.WRROBIN, node[1], 1)\nnode[3].set_routing(jobclass[1], RoutingStrategy.WRROBIN, node[2], 2)",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-30T22:13:52.058913Z",
          "start_time": "2025-07-30T22:13:51.985702Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-02T14:08:51.841020Z",
          "iopub.execute_input": "2026-01-02T14:08:51.841204Z",
          "shell.execute_reply": "2026-01-02T14:08:51.879798Z",
          "iopub.status.idle": "2026-01-02T14:08:51.880271Z"
        }
      },
      "outputs": [],
      "execution_count": 2
    },
    "cell_2": {
      "cell_type": "code",
      "source": "# Solve with JMT and DES (matches MATLAB)\nsimoptions = JMT.default_options()\nsimoptions.verbose = True\nsimoptions.seed = 23000\nsolver = np.array([], dtype = object)\nsolver = np.append(solver, JMT(model, simoptions))\nsolver = np.append(solver, DES(model, simoptions))\n\nAvgTable = np.empty(len(solver), dtype = object)\nfor s in range(len(solver)):\n    print(f'\\nSOLVER: {solver[s].get_name()}')\n    AvgTable[s] = solver[s].avg_table()",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-30T22:13:53.164520Z",
          "start_time": "2025-07-30T22:13:52.066586Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-02T14:08:51.881655Z",
          "iopub.execute_input": "2026-01-02T14:08:51.881828Z",
          "iopub.status.idle": "2026-01-02T14:08:53.095932Z",
          "shell.execute_reply": "2026-01-02T14:08:53.095585Z"
        }
      },
      "outputs": [
        {
          "output_type": "stream",
          "execution_count": null,
          "metadata": {},
          "content": {
            "stream_name": "stdout",
            "text": "\nSOLVER: SolverJMT\nJMT Model: /tmp/workspace/jsim/4972983617194506738/jmodel.jsim\n",
            "numerical_values": [
              4.972983617194506e+18
            ]
          }
        },
        {
          "output_type": "stream",
          "execution_count": null,
          "metadata": {},
          "content": {
            "stream_name": "stdout",
            "text": "  Station JobClass    QLen    Util    RespT  ResidT    ArvR    Tput\n0  Queue1   Class1  0.8750  0.4384   3.1291  0.7823  0.2854  0.2853\n1  Queue1   Class2  0.5292  0.2846   2.9414  0.7354  0.1909  0.1910\n2  Queue2   Class1  7.4761  0.4301  25.8577  6.4644  0.2853  0.2856\n3  Queue2   Class2  9.9986  0.5700  26.1076  6.5269  0.3822  0.3815\n4   Delay   Class1  0.5751  0.5751   0.9990  0.4995  0.5723  0.5724\n5   Delay   Class2  0.5800  0.5800   1.0103  0.5051  0.5720  0.5731\n\nSOLVER: SolverDES\nDES: Transient filter = mser5 (batch size = 5)\nDES: CI method = obm (overlap = 0.5)\nDES events:    200 \b\b\b\b\b\b\b    400\b\b\b\b\b\b\b    600\b\b\b\b\b\b\b    800\b\b\b\b\b\b\b   1000\b\b\b\b\b\b\b   1200\b\b\b\b\b\b\b   1400\b\b\b\b\b\b\b   1600\b\b\b\b\b\b\b   1800\b\b\b\b\b\b\b   2000\b\b\b\b\b\b\b   2200\b\b\b\b\b\b\b   2400\b\b\b\b\b\b\b   2600\b\b\b\b\b\b\b   2800\b\b\b\b\b\b\b   3000\b\b\b\b\b\b\b   3200\b\b\b\b\b\b\b   3400\b\b\b\b\b\b\b   3600\b\b\b\b\b\b\b   3800\b\b\b\b\b\b\b   4000\b\b\b\b\b\b\b   4200\b\b\b\b\b\b\b   4400\b\b\b\b\b\b\b   4600\b\b\b\b\b\b\b   4800\b\b\b\b\b\b\b   5000\b\b\b\b\b\b\b   5200\b\b\b\b\b\b\b   5400\b\b\b\b\b\b\b   5600\b\b\b\b\b\b\b   5800\b\b\b\b\b\b\b   6000\b\b\b\b\b\b\b   6200\b\b\b\b\b\b\b   6400\b\b\b\b\b\b\b   6600\b\b\b\b\b\b\b   6800\b\b\b\b\b\b\b   7000\b\b\b\b\b\b\b   7200\b\b\b\b\b\b\b   7400\b\b\b\b\b\b\b   7600\b\b\b\b\b\b\b   7800\b\b\b\b\b\b\b   8000\b\b\b\b\b\b\b   8200\b\b\b\b\b\b\b   8400\b\b\b\b\b\b\b   8600\b\b\b\b\b\b\b   8800\b\b\b\b\b\b\b   9000\b\b\b\b\b\b\b   9200\b\b\b\b\b\b\b   9400\b\b\b\b\b\b\b   9600\b\b\b\b\b\b\b   9800\b\b\b\b\b\b\b  10000\b\b\b\b\b\b\b  10000\n  Station JobClass    QLen    Util    RespT  ResidT    ArvR    Tput\n0  Queue1   Class1  2.6774  0.4019   9.2496  2.3124  0.2571  0.2629\n1  Queue1   Class2  3.8456  0.2646  21.3532  5.3383  0.2568  0.1764\n2  Queue2   Class1  4.5231  0.3793  18.0861  4.5215  0.2571  0.2504\n3  Queue2   Class2  7.6633  0.5039  24.3086  6.0772  0.2568  0.3363\n4   Delay   Class1  0.6723  0.6723   1.0347  0.5173  0.5127  0.5142\n5   Delay   Class2  0.6183  0.6183   0.9839  0.4920  0.5133  0.5136\n",
            "numerical_values": [
              0.0,
              1.0,
              1.0,
              0.875,
              0.4384,
              3.1291,
              0.7823,
              0.2854,
              0.2853,
              1.0,
              1.0,
              2.0,
              0.5292,
              0.2846,
              2.9414,
              0.7354,
              0.1909,
              0.191,
              2.0,
              2.0,
              1.0,
              7.4761,
              0.4301,
              25.8577,
              6.4644,
              0.2853,
              0.2856,
              3.0,
              2.0,
              2.0,
              9.9986,
              0.57,
              26.1076,
              6.5269,
              0.3822,
              0.3815,
              4.0,
              1.0,
              0.5751,
              0.5751,
              0.999,
              0.4995,
              0.5723,
              0.5724,
              5.0,
              2.0,
              0.58,
              0.58,
              1.0103,
              0.5051,
              0.572,
              0.5731,
              5.0,
              5.0,
              0.5,
              200.0,
              400.0,
              600.0,
              800.0,
              1000.0,
              1200.0,
              1400.0,
              1600.0,
              1800.0,
              2000.0,
              2200.0,
              2400.0,
              2600.0,
              2800.0,
              3000.0,
              3200.0,
              3400.0,
              3600.0,
              3800.0,
              4000.0,
              4200.0,
              4400.0,
              4600.0,
              4800.0,
              5000.0,
              5200.0,
              5400.0,
              5600.0,
              5800.0,
              6000.0,
              6200.0,
              6400.0,
              6600.0,
              6800.0,
              7000.0,
              7200.0,
              7400.0,
              7600.0,
              7800.0,
              8000.0,
              8200.0,
              8400.0,
              8600.0,
              8800.0,
              9000.0,
              9200.0,
              9400.0,
              9600.0,
              9800.0,
              10000.0,
              10000.0,
              0.0,
              1.0,
              1.0,
              2.6774,
              0.4019,
              9.2496,
              2.3124,
              0.2571,
              0.2629,
              1.0,
              1.0,
              2.0,
              3.8456,
              0.2646,
              21.3532,
              5.3383,
              0.2568,
              0.1764,
              2.0,
              2.0,
              1.0,
              4.5231,
              0.3793,
              18.0861,
              4.5215,
              0.2571,
              0.2504,
              3.0,
              2.0,
              2.0,
              7.6633,
              0.5039,
              24.3086,
              6.0772,
              0.2568,
              0.3363,
              4.0,
              1.0,
              0.6723,
              0.6723,
              1.0347,
              0.5173,
              0.5127,
              0.5142,
              5.0,
              2.0,
              0.6183,
              0.6183,
              0.9839,
              0.492,
              0.5133,
              0.5136
            ]
          }
        }
      ],
      "execution_count": 3
    }
  },
  "numerical_summary": {
    "cell_2": [
      4.972983617194506e+18,
      0.0,
      1.0,
      1.0,
      0.875,
      0.4384,
      3.1291,
      0.7823,
      0.2854,
      0.2853,
      1.0,
      1.0,
      2.0,
      0.5292,
      0.2846,
      2.9414,
      0.7354,
      0.1909,
      0.191,
      2.0,
      2.0,
      1.0,
      7.4761,
      0.4301,
      25.8577,
      6.4644,
      0.2853,
      0.2856,
      3.0,
      2.0,
      2.0,
      9.9986,
      0.57,
      26.1076,
      6.5269,
      0.3822,
      0.3815,
      4.0,
      1.0,
      0.5751,
      0.5751,
      0.999,
      0.4995,
      0.5723,
      0.5724,
      5.0,
      2.0,
      0.58,
      0.58,
      1.0103,
      0.5051,
      0.572,
      0.5731,
      5.0,
      5.0,
      0.5,
      200.0,
      400.0,
      600.0,
      800.0,
      1000.0,
      1200.0,
      1400.0,
      1600.0,
      1800.0,
      2000.0,
      2200.0,
      2400.0,
      2600.0,
      2800.0,
      3000.0,
      3200.0,
      3400.0,
      3600.0,
      3800.0,
      4000.0,
      4200.0,
      4400.0,
      4600.0,
      4800.0,
      5000.0,
      5200.0,
      5400.0,
      5600.0,
      5800.0,
      6000.0,
      6200.0,
      6400.0,
      6600.0,
      6800.0,
      7000.0,
      7200.0,
      7400.0,
      7600.0,
      7800.0,
      8000.0,
      8200.0,
      8400.0,
      8600.0,
      8800.0,
      9000.0,
      9200.0,
      9400.0,
      9600.0,
      9800.0,
      10000.0,
      10000.0,
      0.0,
      1.0,
      1.0,
      2.6774,
      0.4019,
      9.2496,
      2.3124,
      0.2571,
      0.2629,
      1.0,
      1.0,
      2.0,
      3.8456,
      0.2646,
      21.3532,
      5.3383,
      0.2568,
      0.1764,
      2.0,
      2.0,
      1.0,
      4.5231,
      0.3793,
      18.0861,
      4.5215,
      0.2571,
      0.2504,
      3.0,
      2.0,
      2.0,
      7.6633,
      0.5039,
      24.3086,
      6.0772,
      0.2568,
      0.3363,
      4.0,
      1.0,
      0.6723,
      0.6723,
      1.0347,
      0.5173,
      0.5127,
      0.5142,
      5.0,
      2.0,
      0.6183,
      0.6183,
      0.9839,
      0.492,
      0.5133,
      0.5136,
      23000.0
    ]
  },
  "metadata": {
    "notebook_path": "closedQN/cqn_twoclass_erl.ipynb",
    "source_dir": "examples/basic",
    "total_cells": 3,
    "code_cells": 3,
    "generation_info": {
      "script_version": "2.0",
      "extraction_method": "comprehensive"
    }
  }
}