{
  "cell_content": {
    "cell_0": {
      "cell_type": "code",
      "source": "from line_solver import *\nimport numpy as np\nGlobalConstants.set_verbose(VerboseLevel.STD)",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-30T22:17:12.900201Z",
          "start_time": "2025-07-30T22:17:11.866604Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-02T14:09:26.191215Z",
          "iopub.execute_input": "2026-01-02T14:09:26.191303Z",
          "iopub.status.idle": "2026-01-02T14:09:27.304210Z",
          "shell.execute_reply": "2026-01-02T14:09:27.303828Z"
        }
      },
      "outputs": [],
      "execution_count": 1
    },
    "cell_1": {
      "cell_type": "code",
      "source": "# Fork-Join with Class Switching\nmodel = Network('model')",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-30T22:17:12.962640Z",
          "start_time": "2025-07-30T22:17:12.958915Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-02T14:09:27.306871Z",
          "iopub.execute_input": "2026-01-02T14:09:27.307154Z",
          "iopub.status.idle": "2026-01-02T14:09:27.315726Z",
          "shell.execute_reply": "2026-01-02T14:09:27.315370Z"
        }
      },
      "outputs": [],
      "execution_count": 2
    },
    "cell_2": {
      "cell_type": "code",
      "source": "# Create network\ndelay = Delay(model, 'Delay1')\ndelay2 = Delay(model, 'Delay2')\nqueue1 = Queue(model,'Queue1',SchedStrategy.PS)\nqueue2 = Queue(model,'Queue2',SchedStrategy.PS)\nfork = Fork(model,'Fork')\njoin = Join(model,'Join', fork)\n\njobclass1 = ClosedClass(model, 'class1', 10, delay, 0)\njobclass2 = ClosedClass(model, 'class2', 10, delay, 0)",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-30T22:17:13.024651Z",
          "start_time": "2025-07-30T22:17:13.012164Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-02T14:09:27.317205Z",
          "iopub.execute_input": "2026-01-02T14:09:27.317360Z",
          "iopub.status.idle": "2026-01-02T14:09:27.337858Z",
          "shell.execute_reply": "2026-01-02T14:09:27.336184Z"
        }
      },
      "outputs": [],
      "execution_count": 3
    },
    "cell_3": {
      "cell_type": "code",
      "source": "# Service configurations\nqueue1.set_service(jobclass1, Exp(1.0))\nqueue2.set_service(jobclass1, Exp(1.0))\ndelay.set_service(jobclass1, Exp(0.5))\ndelay.set_service(jobclass2, Exp(0.5))\ndelay2.set_service(jobclass2, Exp(2.0))",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-30T22:17:13.064684Z",
          "start_time": "2025-07-30T22:17:13.059854Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-02T14:09:27.339936Z",
          "iopub.execute_input": "2026-01-02T14:09:27.340156Z",
          "iopub.status.idle": "2026-01-02T14:09:27.346990Z",
          "shell.execute_reply": "2026-01-02T14:09:27.346635Z"
        }
      },
      "outputs": [],
      "execution_count": 4
    },
    "cell_4": {
      "cell_type": "code",
      "source": "# Set routing matrix with class switching\nP = model.init_routing_matrix()\n\n# Class switching routing: jobclass1 -> jobclass2 -> jobclass1\nP.set(jobclass1, jobclass2, delay, delay2, 1.0)    # Class switch: class1 -> class2 at delay\nP.set(jobclass2, jobclass1, delay2, fork, 1.0)     # Class switch: class2 -> class1 at delay2\n\n# Fork-join routing for class1\nP.set(jobclass1, jobclass1, fork, queue1, 1.0)\nP.set(jobclass1, jobclass1, fork, queue2, 1.0)\nP.set(jobclass1, jobclass1, queue1, join, 1.0)\nP.set(jobclass1, jobclass1, queue2, join, 1.0)\nP.set(jobclass1, jobclass1, join, delay, 1.0)\n\nmodel.link(P)",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-30T22:17:13.123824Z",
          "start_time": "2025-07-30T22:17:13.109568Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-02T14:09:27.348285Z",
          "iopub.execute_input": "2026-01-02T14:09:27.348413Z",
          "iopub.status.idle": "2026-01-02T14:09:27.361211Z",
          "shell.execute_reply": "2026-01-02T14:09:27.360855Z"
        }
      },
      "outputs": [],
      "execution_count": 5
    },
    "cell_5": {
      "cell_type": "code",
      "source": "# Solve with multiple methods\nsolvers = [JMT(model, seed=23000), MVA(model)]\nfor i, solver in enumerate(solvers):\n    print(f'SOLVER {i+1}: {solver.get_name()}')\n    avgTable = solver.avg_table()",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-30T22:17:15.100683Z",
          "start_time": "2025-07-30T22:17:13.159882Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-02T14:09:27.362543Z",
          "iopub.execute_input": "2026-01-02T14:09:27.362759Z",
          "iopub.status.idle": "2026-01-02T14:09:29.773710Z",
          "shell.execute_reply": "2026-01-02T14:09:29.773297Z"
        }
      },
      "outputs": [
        {
          "output_type": "stream",
          "execution_count": null,
          "metadata": {},
          "content": {
            "stream_name": "stdout",
            "text": "SOLVER 1: SolverJMT\nJMT Model: /tmp/workspace/jsim/17160660471806205901/jmodel.jsim\n",
            "numerical_values": [
              1.0,
              1.7160660471806206e+19
            ]
          }
        },
        {
          "output_type": "stream",
          "execution_count": null,
          "metadata": {},
          "content": {
            "stream_name": "stdout",
            "text": "  Station JobClass     QLen    Util    RespT  ResidT    ArvR    Tput\n0  Delay1   class1   1.9093  1.9093   1.9791  1.9791  0.9831  0.9821\n1  Delay2   class2   0.4864  0.4864   0.5077  0.5077  0.9821  0.9836\n2  Queue1   class1  12.7339  0.9808  12.7957  6.3979  0.9836  0.9837\n3  Queue2   class1   9.0597  0.9583   9.8528  4.9264  0.9836  0.9821\n4    Join   class1  13.3251  0.0000   6.9336  6.9336  1.9492  0.9831\nSOLVER 2: SolverMVA\n",
            "numerical_values": [
              0.0,
              1.0,
              1.0,
              1.9093,
              1.9093,
              1.9791,
              1.9791,
              0.9831,
              0.9821,
              1.0,
              2.0,
              2.0,
              0.4864,
              0.4864,
              0.5077,
              0.5077,
              0.9821,
              0.9836,
              2.0,
              1.0,
              1.0,
              12.7339,
              0.9808,
              12.7957,
              6.3979,
              0.9836,
              0.9837,
              3.0,
              2.0,
              1.0,
              9.0597,
              0.9583,
              9.8528,
              4.9264,
              0.9836,
              0.9821,
              4.0,
              1.0,
              13.3251,
              0.0,
              6.9336,
              6.9336,
              1.9492,
              0.9831,
              2.0
            ]
          }
        },
        {
          "output_type": "stream",
          "execution_count": null,
          "metadata": {},
          "content": {
            "stream_name": "stdout",
            "text": "  Station JobClass     QLen    Util    RespT  ResidT    ArvR    Tput\n0  Delay1   class1   1.8658  1.8658   2.0000  2.0000  0.9329  0.9329\n1  Delay2   class2   0.4665  0.4665   0.5000  0.5000  0.9329  0.9329\n2  Queue1   class1  11.8695  0.9329  12.7229  6.3614  0.9329  0.9329\n3  Queue2   class1  11.8695  0.9329  12.7229  6.3614  0.9329  0.9329\n4    Join   class1  11.8701  0.0000   6.3618  6.3618  1.8658  0.9329\n",
            "numerical_values": [
              0.0,
              1.0,
              1.0,
              1.8658,
              1.8658,
              2.0,
              2.0,
              0.9329,
              0.9329,
              1.0,
              2.0,
              2.0,
              0.4665,
              0.4665,
              0.5,
              0.5,
              0.9329,
              0.9329,
              2.0,
              1.0,
              1.0,
              11.8695,
              0.9329,
              12.7229,
              6.3614,
              0.9329,
              0.9329,
              3.0,
              2.0,
              1.0,
              11.8695,
              0.9329,
              12.7229,
              6.3614,
              0.9329,
              0.9329,
              4.0,
              1.0,
              11.8701,
              0.0,
              6.3618,
              6.3618,
              1.8658,
              0.9329
            ]
          }
        }
      ],
      "execution_count": 6
    }
  },
  "numerical_summary": {
    "cell_5": [
      1.0,
      1.7160660471806206e+19,
      0.0,
      1.0,
      1.0,
      1.9093,
      1.9093,
      1.9791,
      1.9791,
      0.9831,
      0.9821,
      1.0,
      2.0,
      2.0,
      0.4864,
      0.4864,
      0.5077,
      0.5077,
      0.9821,
      0.9836,
      2.0,
      1.0,
      1.0,
      12.7339,
      0.9808,
      12.7957,
      6.3979,
      0.9836,
      0.9837,
      3.0,
      2.0,
      1.0,
      9.0597,
      0.9583,
      9.8528,
      4.9264,
      0.9836,
      0.9821,
      4.0,
      1.0,
      13.3251,
      0.0,
      6.9336,
      6.9336,
      1.9492,
      0.9831,
      2.0,
      0.0,
      1.0,
      1.0,
      1.8658,
      1.8658,
      2.0,
      2.0,
      0.9329,
      0.9329,
      1.0,
      2.0,
      2.0,
      0.4665,
      0.4665,
      0.5,
      0.5,
      0.9329,
      0.9329,
      2.0,
      1.0,
      1.0,
      11.8695,
      0.9329,
      12.7229,
      6.3614,
      0.9329,
      0.9329,
      3.0,
      2.0,
      1.0,
      11.8695,
      0.9329,
      12.7229,
      6.3614,
      0.9329,
      0.9329,
      4.0,
      1.0,
      11.8701,
      0.0,
      6.3618,
      6.3618,
      1.8658,
      0.9329,
      23000.0,
      1.0
    ]
  },
  "metadata": {
    "notebook_path": "forkJoin/fj_cs_prefork.ipynb",
    "source_dir": "examples/basic",
    "total_cells": 6,
    "code_cells": 6,
    "generation_info": {
      "script_version": "2.0",
      "extraction_method": "comprehensive"
    }
  }
}