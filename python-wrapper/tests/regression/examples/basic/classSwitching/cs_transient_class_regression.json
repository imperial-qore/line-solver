{
  "cell_content": {
    "cell_0": {
      "cell_type": "code",
      "source": "from line_solver import *\nimport numpy as np\nGlobalConstants.set_verbose(VerboseLevel.STD)",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-30T22:11:51.917901Z",
          "start_time": "2025-07-30T22:11:51.915265Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-02T14:08:21.522513Z",
          "iopub.execute_input": "2026-01-02T14:08:21.522610Z",
          "iopub.status.idle": "2026-01-02T14:08:22.322090Z",
          "shell.execute_reply": "2026-01-02T14:08:22.321755Z"
        }
      },
      "outputs": [],
      "execution_count": 1
    },
    "cell_1": {
      "cell_type": "code",
      "source": "# Class switching example 4\n# Example of class switching controlled by a reducible Markov chain\n# In this variant the job remains either in class 2 or class 3 forever\nmodel = Network('reducible_cs')",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-30T22:11:51.971168Z",
          "start_time": "2025-07-30T22:11:51.969056Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-02T14:08:22.323256Z",
          "iopub.execute_input": "2026-01-02T14:08:22.323436Z",
          "iopub.status.idle": "2026-01-02T14:08:22.330688Z",
          "shell.execute_reply": "2026-01-02T14:08:22.330377Z"
        }
      },
      "outputs": [],
      "execution_count": 2
    },
    "cell_2": {
      "cell_type": "code",
      "source": "# Block 1: nodes\nnode = np.empty(3, dtype=object)\nnode[0] = Delay(model, 'Queue 0')\nnode[1] = Delay(model, 'Queue 1')\nnode[2] = Delay(model, 'Queue 2')\n\n# Block 2: classes\njobclass = np.empty(3, dtype=object)\njobclass[0] = ClosedClass(model, 'Class1', 1, node[0])\njobclass[1] = ClosedClass(model, 'Class2', 0, node[0])\njobclass[2] = ClosedClass(model, 'Class3', 0, node[0])",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-30T22:11:52.021173Z",
          "start_time": "2025-07-30T22:11:52.018599Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-02T14:08:22.331591Z",
          "iopub.execute_input": "2026-01-02T14:08:22.331734Z",
          "shell.execute_reply": "2026-01-02T14:08:22.339084Z",
          "iopub.status.idle": "2026-01-02T14:08:22.339354Z"
        }
      },
      "outputs": [],
      "execution_count": 3
    },
    "cell_3": {
      "cell_type": "code",
      "source": "# Service configurations\nnode[0].set_service(jobclass[0], Exp.fit_mean(1.000000))  # (Queue 0,Class1)\nnode[0].set_service(jobclass[1], Exp.fit_mean(1.000000))  # (Queue 0,Class2)\nnode[0].set_service(jobclass[2], Exp.fit_mean(1.000000))  # (Queue 0,Class3)\nnode[1].set_service(jobclass[1], Exp.fit_mean(1.000000))  # (Queue 1,Class2)\nnode[2].set_service(jobclass[2], Exp.fit_mean(1.000000))  # (Queue 2,Class3)",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-30T22:11:52.071566Z",
          "start_time": "2025-07-30T22:11:52.069449Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-02T14:08:22.340420Z",
          "iopub.execute_input": "2026-01-02T14:08:22.340536Z",
          "iopub.status.idle": "2026-01-02T14:08:22.346041Z",
          "shell.execute_reply": "2026-01-02T14:08:22.345757Z"
        }
      },
      "outputs": [],
      "execution_count": 4
    },
    "cell_4": {
      "cell_type": "code",
      "source": "# Routing matrix with class switching - transient class example\nP = model.init_routing_matrix()  # initialize routing matrix\n\n# Class 1 routing: transitions to classes 2 and 3, or stays in class 1\nP.set(jobclass[0], jobclass[0], node[0], node[0], 0.2)  # Stay in class 1 at node 0\nP.set(jobclass[0], jobclass[1], node[0], node[0], 0.3)  # Switch to class 2 at node 0  \nP.set(jobclass[0], jobclass[2], node[0], node[0], 0.5)  # Switch to class 3 at node 0\n\n# Class 2 routing: once in class 2, stays in class 2\nP.set(jobclass[1], jobclass[1], node[0], node[1], 1.0)  # Class 2: node 0 to node 1\nP.set(jobclass[1], jobclass[1], node[1], node[0], 1.0)  # Class 2: node 1 to node 0\n\n# Class 3 routing: once in class 3, stays in class 3  \nP.set(jobclass[2], jobclass[2], node[0], node[2], 1.0)  # Class 3: node 0 to node 2\nP.set(jobclass[2], jobclass[2], node[2], node[0], 1.0)  # Class 3: node 2 to node 0\n\nmodel.link(P)",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-30T22:11:52.124352Z",
          "start_time": "2025-07-30T22:11:52.121174Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-02T14:08:22.347047Z",
          "iopub.execute_input": "2026-01-02T14:08:22.347171Z",
          "iopub.status.idle": "2026-01-02T14:08:22.356210Z",
          "shell.execute_reply": "2026-01-02T14:08:22.355939Z"
        }
      },
      "outputs": [],
      "execution_count": 5
    },
    "cell_5": {
      "cell_type": "code",
      "source": "#model.printRoutingMatrix()",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-30T22:11:52.171955Z",
          "start_time": "2025-07-30T22:11:52.170349Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-02T14:08:22.357488Z",
          "iopub.execute_input": "2026-01-02T14:08:22.357653Z",
          "iopub.status.idle": "2026-01-02T14:08:22.359038Z",
          "shell.execute_reply": "2026-01-02T14:08:22.358836Z"
        }
      },
      "outputs": [],
      "execution_count": 6
    },
    "cell_6": {
      "cell_type": "code",
      "source": "# Solve using JMT solver (better for class switching models)\nsolver = JMT(model)\nAvgTable = solver.avg_chain_table()",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-30T22:11:52.318265Z",
          "start_time": "2025-07-30T22:11:52.215457Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-02T14:08:22.359974Z",
          "iopub.execute_input": "2026-01-02T14:08:22.360082Z",
          "shell.execute_reply": "2026-01-02T14:08:23.396866Z",
          "iopub.status.idle": "2026-01-02T14:08:23.397139Z"
        }
      },
      "outputs": [
        {
          "output_type": "stream",
          "execution_count": null,
          "metadata": {},
          "content": {
            "stream_name": "stdout",
            "text": "JMT Model: /tmp/workspace/jsim/7548557110511327688/jmodel.jsim\n",
            "numerical_values": [
              7.548557110511327e+18
            ]
          }
        },
        {
          "output_type": "stream",
          "execution_count": null,
          "metadata": {},
          "content": {
            "stream_name": "stdout",
            "text": "   Station   Chain    QLen    Util   RespT  ResidT    ArvR    Tput\n0  Queue 0  Chain1  0.4982  0.4982  0.8700  0.8700  6.5883  3.8065\n2  Queue 2  Chain1  0.5021  0.5021  1.0002  0.8752  0.5018  0.5083\n",
            "numerical_values": [
              0.0,
              0.0,
              1.0,
              0.4982,
              0.4982,
              0.87,
              0.87,
              6.5883,
              3.8065,
              2.0,
              2.0,
              1.0,
              0.5021,
              0.5021,
              1.0002,
              0.8752,
              0.5018,
              0.5083
            ]
          }
        }
      ],
      "execution_count": 7
    }
  },
  "numerical_summary": {
    "cell_1": [
      4.0,
      2.0,
      3.0
    ],
    "cell_6": [
      7.548557110511327e+18,
      0.0,
      0.0,
      1.0,
      0.4982,
      0.4982,
      0.87,
      0.87,
      6.5883,
      3.8065,
      2.0,
      2.0,
      1.0,
      0.5021,
      0.5021,
      1.0002,
      0.8752,
      0.5018,
      0.5083
    ]
  },
  "metadata": {
    "notebook_path": "classSwitching/cs_transient_class.ipynb",
    "source_dir": "examples/basic",
    "total_cells": 7,
    "code_cells": 7,
    "generation_info": {
      "script_version": "2.0",
      "extraction_method": "comprehensive"
    }
  }
}