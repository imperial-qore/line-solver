{
  "cell_content": {
    "cell_0": {
      "cell_type": "code",
      "source": "from line_solver import *\nGlobalConstants.set_verbose(VerboseLevel.STD)",
      "metadata": {
        "collapsed": false,
        "ExecuteTime": {
          "end_time": "2025-07-15T22:49:58.542685Z",
          "start_time": "2025-07-15T22:49:58.527020Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-02T14:15:46.564676Z",
          "iopub.execute_input": "2026-01-02T14:15:46.564776Z",
          "iopub.status.idle": "2026-01-02T14:15:47.439681Z",
          "shell.execute_reply": "2026-01-02T14:15:47.439348Z"
        }
      },
      "outputs": [],
      "execution_count": 1
    },
    "cell_1": {
      "cell_type": "code",
      "source": "model = Network('model')\n\nnode = np.empty(3, dtype=object)\nnode[0] = Delay(model, 'Delay')\nnode[1] = Queue(model, 'Queue1', SchedStrategy.PS)\nnode[2] = Queue(model, 'Queue2', SchedStrategy.FCFS)\n\njobclass = np.empty(2, dtype=object)\njobclass[0] = ClosedClass(model, 'Class1', 1, node[0], 0)\njobclass[1] = ClosedClass(model, 'Class2', 2, node[0], 0)\n\n# renewal\nmap21 = APH([1,0],[[-2,2],[0,-0.5]])\nmap22 = MAP([-1],[1]) \n# non-renewal\nmap31 = MAP([[-20,0],[0,-1]],[[0,20],[0.8,0.2]])\nmap32 = MAP([[-20,0],[0,-1]],[[0,20],[0.8,0.2]])\n\nnode[0].set_service(jobclass[0], HyperExp.fit_mean_and_scv(1.0,25.0))\nnode[1].set_service(jobclass[0], map21)\nnode[2].set_service(jobclass[0], map31)\n\nnode[0].set_service(jobclass[1], HyperExp.fit_mean_and_scv(1.0,25.0))\nnode[1].set_service(jobclass[1], map22)\nnode[2].set_service(jobclass[1], map32)\n\nmodel.add_link(node[0], node[0])\nmodel.add_link(node[0], node[1])\nmodel.add_link(node[0], node[2])\nmodel.add_link(node[1], node[0])\nmodel.add_link(node[2], node[0])\n\nnode[0].set_routing(jobclass[0],RoutingStrategy.RROBIN) # if changed to RAND the EJML exception goes\nnode[1].set_prob_routing(jobclass[0], node[0], 1.0)\nnode[2].set_prob_routing(jobclass[0], node[0], 1.0)\n\nnode[0].set_routing(jobclass[1],RoutingStrategy.RROBIN) # if changed to RAND the EJML exception goes\nnode[1].set_prob_routing(jobclass[1], node[0], 1.0)\nnode[2].set_prob_routing(jobclass[1], node[0], 1.0)",
      "metadata": {
        "collapsed": false,
        "ExecuteTime": {
          "end_time": "2025-07-15T22:49:58.846684Z",
          "start_time": "2025-07-15T22:49:58.737946Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-02T14:15:47.440787Z",
          "iopub.execute_input": "2026-01-02T14:15:47.440952Z",
          "iopub.status.idle": "2026-01-02T14:15:47.488080Z",
          "shell.execute_reply": "2026-01-02T14:15:47.487685Z"
        }
      },
      "outputs": [],
      "execution_count": 2
    },
    "cell_2": {
      "cell_type": "code",
      "source": "solver = np.array([], dtype=object)\nsolver = np.append(solver, JMT(model, seed=23000))\nsolver = np.append(solver, CTMC(model, keep=False))",
      "metadata": {
        "collapsed": false,
        "ExecuteTime": {
          "end_time": "2025-07-15T22:50:44.705459Z",
          "start_time": "2025-07-15T22:50:44.488195Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-02T14:15:47.489268Z",
          "iopub.execute_input": "2026-01-02T14:15:47.489490Z",
          "iopub.status.idle": "2026-01-02T14:15:47.536286Z",
          "shell.execute_reply": "2026-01-02T14:15:47.536008Z"
        }
      },
      "outputs": [],
      "execution_count": 3
    },
    "cell_3": {
      "cell_type": "code",
      "source": "AvgTable = np.empty(len(solver), dtype=object)\nfor s in range(len(solver)):\n    print(f'\\nSOLVER: {solver[s].get_name()}')\n    try:\n        AvgTable[s] = solver[s].avg_table()\n        print(AvgTable[s])\n    except Exception as e:\n        print(f\"Solver error: {type(e).__name__} - Non-FCFS MAP stations may not be supported\")",
      "metadata": {
        "collapsed": false,
        "ExecuteTime": {
          "end_time": "2025-07-15T22:50:54.387421Z",
          "start_time": "2025-07-15T22:50:45.985125Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-02T14:15:47.537473Z",
          "iopub.execute_input": "2026-01-02T14:15:47.537571Z",
          "iopub.status.idle": "2026-01-02T14:15:48.612915Z",
          "shell.execute_reply": "2026-01-02T14:15:48.610683Z"
        }
      },
      "outputs": [
        {
          "output_type": "stream",
          "execution_count": null,
          "metadata": {},
          "content": {
            "stream_name": "stdout",
            "text": "\nSOLVER: SolverJMT\nJMT Model: /tmp/workspace/jsim/17972691733967545242/jmodel.jsim\n",
            "numerical_values": [
              1.7972691733967544e+19
            ]
          }
        },
        {
          "output_type": "stream",
          "execution_count": null,
          "metadata": {},
          "content": {
            "stream_name": "stdout",
            "text": "  Station JobClass    QLen    Util   RespT  ResidT    ArvR    Tput\n0   Delay   Class1  0.4238  0.4238  1.0158  1.0158  0.3896  0.3896\n1   Delay   Class2  1.1440  1.1440  0.9474  0.9474  1.1793  1.1791\n2  Queue1   Class1  0.4884  0.3307  3.6702  1.2234  0.1340  0.1340\n3  Queue1   Class2  0.5799  0.3575  1.5453  0.5151  0.3733  0.3733\n4  Queue2   Class1  0.1081  0.0778  0.8230  0.2743  0.1341  0.1343\n5  Queue2   Class2  0.2562  0.2159  0.6946  0.2315  0.3733  0.3733\n  Station JobClass    QLen    Util   RespT  ResidT    ArvR    Tput\n0   Delay   Class1  0.4238  0.4238  1.0158  1.0158  0.3896  0.3896\n1   Delay   Class2  1.1440  1.1440  0.9474  0.9474  1.1793  1.1791\n2  Queue1   Class1  0.4884  0.3307  3.6702  1.2234  0.1340  0.1340\n3  Queue1   Class2  0.5799  0.3575  1.5453  0.5151  0.3733  0.3733\n4  Queue2   Class1  0.1081  0.0778  0.8230  0.2743  0.1341  0.1343\n5  Queue2   Class2  0.2562  0.2159  0.6946  0.2315  0.3733  0.3733\n\nSOLVER: SolverCTMC\nSolver error: java.lang.RuntimeException - Non-FCFS MAP stations may not be supported\n",
            "numerical_values": [
              0.0,
              1.0,
              0.4238,
              0.4238,
              1.0158,
              1.0158,
              0.3896,
              0.3896,
              1.0,
              2.0,
              1.144,
              1.144,
              0.9474,
              0.9474,
              1.1793,
              1.1791,
              2.0,
              1.0,
              1.0,
              0.4884,
              0.3307,
              3.6702,
              1.2234,
              0.134,
              0.134,
              3.0,
              1.0,
              2.0,
              0.5799,
              0.3575,
              1.5453,
              0.5151,
              0.3733,
              0.3733,
              4.0,
              2.0,
              1.0,
              0.1081,
              0.0778,
              0.823,
              0.2743,
              0.1341,
              0.1343,
              5.0,
              2.0,
              2.0,
              0.2562,
              0.2159,
              0.6946,
              0.2315,
              0.3733,
              0.3733,
              0.0,
              1.0,
              0.4238,
              0.4238,
              1.0158,
              1.0158,
              0.3896,
              0.3896,
              1.0,
              2.0,
              1.144,
              1.144,
              0.9474,
              0.9474,
              1.1793,
              1.1791,
              2.0,
              1.0,
              1.0,
              0.4884,
              0.3307,
              3.6702,
              1.2234,
              0.134,
              0.134,
              3.0,
              1.0,
              2.0,
              0.5799,
              0.3575,
              1.5453,
              0.5151,
              0.3733,
              0.3733,
              4.0,
              2.0,
              1.0,
              0.1081,
              0.0778,
              0.823,
              0.2743,
              0.1341,
              0.1343,
              5.0,
              2.0,
              2.0,
              0.2562,
              0.2159,
              0.6946,
              0.2315,
              0.3733,
              0.3733
            ]
          }
        },
        {
          "output_type": "stream",
          "execution_count": null,
          "metadata": {},
          "content": {
            "stream_name": "stderr",
            "text": "java.lang.RuntimeException: Non-FCFS MAP stations are not supported.\n\tat jline.lang.state.FromMarginal.fromMarginal(FromMarginal.java:58)\n\tat jline.lang.state.FromMarginal.fromMarginalBounds(FromMarginal.java:1634)\n\tat jline.lang.state.State.spaceGeneratorNodes(State.java:1844)\n\tat jline.lang.state.State.spaceGenerator(State.java:1536)\n\tat jline.api.mc.Ctmc_ssgKt.ctmc_ssg(Ctmc_ssg.kt:14)\n\tat jline.solvers.ctmc.handlers.Solver_ctmc$Companion.solver_ctmc(Solver_ctmc.kt:54)\n\tat jline.solvers.ctmc.analyzers.Solver_ctmc_analyzer$Companion.solver_ctmc_analyzer(Solver_ctmc_analyzer.kt:37)\n\tat jline.solvers.ctmc.analyzers.Solver_ctmc_analyzer.solver_ctmc_analyzer(Solver_ctmc_analyzer.kt)\n\tat jline.solvers.ctmc.SolverCTMC.runAnalyzer(SolverCTMC.java:1013)\n\tat jline.solvers.NetworkSolver.getAvg(NetworkSolver.java:646)\n\tat jline.solvers.NetworkSolver.getAvgTable(NetworkSolver.java:3305)\n",
            "numerical_values": [
              58.0,
              1634.0,
              1844.0,
              1536.0,
              14.0,
              54.0,
              37.0,
              1013.0,
              646.0,
              3305.0
            ]
          }
        }
      ],
      "execution_count": 4
    }
  },
  "numerical_summary": {
    "cell_2": [
      23000.0
    ],
    "cell_3": [
      1.7972691733967544e+19,
      0.0,
      1.0,
      0.4238,
      0.4238,
      1.0158,
      1.0158,
      0.3896,
      0.3896,
      1.0,
      2.0,
      1.144,
      1.144,
      0.9474,
      0.9474,
      1.1793,
      1.1791,
      2.0,
      1.0,
      1.0,
      0.4884,
      0.3307,
      3.6702,
      1.2234,
      0.134,
      0.134,
      3.0,
      1.0,
      2.0,
      0.5799,
      0.3575,
      1.5453,
      0.5151,
      0.3733,
      0.3733,
      4.0,
      2.0,
      1.0,
      0.1081,
      0.0778,
      0.823,
      0.2743,
      0.1341,
      0.1343,
      5.0,
      2.0,
      2.0,
      0.2562,
      0.2159,
      0.6946,
      0.2315,
      0.3733,
      0.3733,
      0.0,
      1.0,
      0.4238,
      0.4238,
      1.0158,
      1.0158,
      0.3896,
      0.3896,
      1.0,
      2.0,
      1.144,
      1.144,
      0.9474,
      0.9474,
      1.1793,
      1.1791,
      2.0,
      1.0,
      1.0,
      0.4884,
      0.3307,
      3.6702,
      1.2234,
      0.134,
      0.134,
      3.0,
      1.0,
      2.0,
      0.5799,
      0.3575,
      1.5453,
      0.5151,
      0.3733,
      0.3733,
      4.0,
      2.0,
      1.0,
      0.1081,
      0.0778,
      0.823,
      0.2743,
      0.1341,
      0.1343,
      5.0,
      2.0,
      2.0,
      0.2562,
      0.2159,
      0.6946,
      0.2315,
      0.3733,
      0.3733,
      58.0,
      1634.0,
      1844.0,
      1536.0,
      14.0,
      54.0,
      37.0,
      1013.0,
      646.0,
      3305.0
    ]
  },
  "metadata": {
    "notebook_path": "stateDepRouting/sdroute_twoclasses_closed.ipynb",
    "source_dir": "examples/advanced",
    "total_cells": 4,
    "code_cells": 4,
    "generation_info": {
      "script_version": "2.0",
      "extraction_method": "comprehensive"
    }
  }
}