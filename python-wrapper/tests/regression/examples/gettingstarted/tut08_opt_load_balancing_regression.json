{
  "cell_content": {
    "cell_0": {
      "cell_type": "code",
      "source": "from line_solver import *\nfrom scipy import optimize\nimport numpy as np",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-27T17:24:18.174188Z",
          "start_time": "2025-07-27T17:24:17.079792Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-02T14:07:35.621178Z",
          "iopub.execute_input": "2026-01-02T14:07:35.621267Z",
          "iopub.status.idle": "2026-01-02T14:07:36.606178Z",
          "shell.execute_reply": "2026-01-02T14:07:36.605903Z"
        }
      },
      "outputs": [],
      "execution_count": 1
    },
    "cell_1": {
      "cell_type": "code",
      "source": "model = Network('LoadBalCQN')\n# Block 1: nodes\ndelay = Delay(model, 'Think')\nqueue1 = Queue(model, 'Queue1', SchedStrategy.PS)\nqueue2 = Queue(model, 'Queue2', SchedStrategy.PS)\n# Block 2: classes\ncclass = ClosedClass(model, 'Job1', 16, delay)\ndelay.set_service(cclass, Exp(1))\nqueue1.set_service(cclass, Exp(0.75))\nqueue2.set_service(cclass, Exp(0.50))\nP = model.init_routing_matrix()\nP.set(cclass, cclass, queue1, delay, 1.0)\nP.set(cclass, cclass, queue2, delay, 1.0)\nmodel.link(P)\n\ndef objFun(p):\n    P.set(cclass, cclass, delay, queue1, p)\n    P.set(cclass, cclass, delay, queue2, 1.0 - p)\n    model.relink(P)\n    # Block 4: solution\n    R = MVA(model, method='exact', verbose=False).avg_sys_resp_t()    \n    return R[0]",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-27T17:24:18.243846Z",
          "start_time": "2025-07-27T17:24:18.226182Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-02T14:07:36.607389Z",
          "iopub.execute_input": "2026-01-02T14:07:36.607529Z",
          "iopub.status.idle": "2026-01-02T14:07:36.625928Z",
          "shell.execute_reply": "2026-01-02T14:07:36.625667Z"
        }
      },
      "outputs": [],
      "execution_count": 2
    },
    "cell_2": {
      "cell_type": "code",
      "source": "p_opt = optimize.fminbound(objFun, 0, 1)\nprint(p_opt[0])",
      "metadata": {
        "ExecuteTime": {
          "end_time": "2025-07-27T17:24:18.371769Z",
          "start_time": "2025-07-27T17:24:18.274329Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-02T14:07:36.627002Z",
          "iopub.execute_input": "2026-01-02T14:07:36.627141Z",
          "iopub.status.idle": "2026-01-02T14:07:36.884328Z",
          "shell.execute_reply": "2026-01-02T14:07:36.884017Z"
        }
      },
      "outputs": [
        {
          "output_type": "stream",
          "execution_count": null,
          "metadata": {},
          "content": {
            "stream_name": "stdout",
            "text": "[[19.77711309]]\n[[13.65298573]]\n[[16.29734017]]\n[[13.63923075]]\n[[13.65182599]]\n[[13.63823752]]\n[[13.63823663]]\n[[13.63823658]]\n[[13.63823658]]\n[[13.63823658]]\n0.6104878504366782\n",
            "numerical_values": [
              19.77711309,
              13.65298573,
              16.29734017,
              13.63923075,
              13.65182599,
              13.63823752,
              13.63823663,
              13.63823658,
              13.63823658,
              13.63823658,
              0.6104878504366782
            ]
          }
        }
      ],
      "execution_count": 3
    },
    "cell_3": {
      "cell_type": "code",
      "source": "import matplotlib.pyplot as plt\ny = []\nx = np.arange(0.01,1,0.01)\ny = np.array(list(map(lambda x:objFun(x), x)))\nplt.plot(x, y)",
      "metadata": {
        "collapsed": false,
        "ExecuteTime": {
          "end_time": "2025-07-27T17:24:18.742324Z",
          "start_time": "2025-07-27T17:24:18.382314Z"
        },
        "execution": {
          "iopub.status.busy": "2026-01-02T14:07:36.885249Z",
          "iopub.execute_input": "2026-01-02T14:07:36.885367Z",
          "iopub.status.idle": "2026-01-02T14:07:37.570938Z",
          "shell.execute_reply": "2026-01-02T14:07:37.570656Z"
        }
      },
      "outputs": [
        {
          "output_type": "stream",
          "execution_count": null,
          "metadata": {},
          "content": {
            "stream_name": "stdout",
            "text": "[[31.68]]\n[[31.36]]\n[[31.04]]\n[[30.72]]\n[[30.4]]\n[[30.08]]\n[[29.76]]\n[[29.44]]\n[[29.12]]\n[[28.8]]\n[[28.48]]\n[[28.16]]\n[[27.84]]\n[[27.52]]\n[[27.2]]\n[[26.88]]\n[[26.56]]\n[[26.24]]\n[[25.92]]\n[[25.6]]\n[[25.28]]\n[[24.96]]\n[[24.64]]\n[[24.32]]\n[[24.00000001]]\n[[23.68000001]]\n[[23.36000003]]\n[[23.04000005]]\n[[22.7200001]]\n[[22.40000019]]\n[[22.08000035]]\n",
            "numerical_values": [
              31.68,
              31.36,
              31.04,
              30.72,
              30.4,
              30.08,
              29.76,
              29.44,
              29.12,
              28.8,
              28.48,
              28.16,
              27.84,
              27.52,
              27.2,
              26.88,
              26.56,
              26.24,
              25.92,
              25.6,
              25.28,
              24.96,
              24.64,
              24.32,
              24.00000001,
              23.68000001,
              23.36000003,
              23.04000005,
              22.7200001,
              22.40000019,
              22.08000035
            ]
          }
        },
        {
          "output_type": "stream",
          "execution_count": null,
          "metadata": {},
          "content": {
            "stream_name": "stdout",
            "text": "[[21.76000066]]\n[[21.44000121]]\n[[21.12000221]]\n[[20.800004]]\n[[20.4800072]]\n[[20.16001284]]\n[[19.84002276]]\n[[19.52004006]]\n[[19.20007007]]\n[[18.88012179]]\n[[18.56021042]]\n[[18.24036144]]\n[[17.92061721]]\n[[17.60104784]]\n[[17.28176831]]\n[[16.96296572]]\n[[16.64494146]]\n[[16.32817538]]\n[[16.01342077]]\n[[15.70183981]]\n[[15.39518726]]\n[[15.09604125]]\n[[14.80806069]]\n[[14.53621263]]\n[[14.2868645]]\n[[14.06759136]]\n[[13.88655085]]\n[[13.75138127]]\n[[26.33559322]]\n[[13.6382996]]\n[[13.66152403]]\n[[13.73251287]]\n[[13.84382306]]\n[[13.98699937]]\n[[14.15389873]]\n[[14.33754814]]\n[[14.53248988]]\n[[14.73474521]]\n[[14.9415749]]\n[[15.15117942]]\n[[15.36242186]]\n[[15.5746074]]\n[[15.78732358]]\n[[16.00033184]]\n[[16.21349745]]\n",
            "numerical_values": [
              21.76000066,
              21.44000121,
              21.12000221,
              20.800004,
              20.4800072,
              20.16001284,
              19.84002276,
              19.52004006,
              19.20007007,
              18.88012179,
              18.56021042,
              18.24036144,
              17.92061721,
              17.60104784,
              17.28176831,
              16.96296572,
              16.64494146,
              16.32817538,
              16.01342077,
              15.70183981,
              15.39518726,
              15.09604125,
              14.80806069,
              14.53621263,
              14.2868645,
              14.06759136,
              13.88655085,
              13.75138127,
              26.33559322,
              13.6382996,
              13.66152403,
              13.73251287,
              13.84382306,
              13.98699937,
              14.15389873,
              14.33754814,
              14.53248988,
              14.73474521,
              14.9415749,
              15.15117942,
              15.36242186,
              15.5746074,
              15.78732358,
              16.00033184,
              16.21349745
            ]
          }
        },
        {
          "output_type": "stream",
          "execution_count": null,
          "metadata": {},
          "content": {
            "stream_name": "stdout",
            "text": "[[16.42674606]]\n[[16.64003753]]\n[[16.85335065]]\n[[17.06667445]]\n[[17.2800034]]\n[[17.49333478]]\n[[17.70666726]]\n[[17.92000024]]\n[[18.13333342]]\n[[18.3466667]]\n[[18.56000001]]\n[[18.77333334]]\n[[18.98666667]]\n[[19.2]]\n[[19.41333333]]\n[[19.62666667]]\n[[19.84]]\n[[20.05333333]]\n[[20.26666667]]\n[[20.48]]\n[[20.69333333]]\n[[20.90666667]]\n[[21.12]]\n",
            "numerical_values": [
              16.42674606,
              16.64003753,
              16.85335065,
              17.06667445,
              17.2800034,
              17.49333478,
              17.70666726,
              17.92000024,
              18.13333342,
              18.3466667,
              18.56000001,
              18.77333334,
              18.98666667,
              19.2,
              19.41333333,
              19.62666667,
              19.84,
              20.05333333,
              20.26666667,
              20.48,
              20.69333333,
              20.90666667,
              21.12
            ]
          }
        },
        {
          "output_type": "execute_result",
          "execution_count": 4,
          "metadata": {},
          "content": {
            "text/plain": "[<matplotlib.lines.Line2D at 0x7dfceacdd950>]",
            "numerical_values": [
              2.0,
              0.0,
              7.0,
              950.0
            ]
          }
        },
        {
          "output_type": "display_data",
          "execution_count": null,
          "metadata": {},
          "content": {
            "text/plain": "<Figure size 640x480 with 1 Axes>",
            "numerical_values": [
              640.0,
              480.0,
              1.0
            ],
            "image/png": "<image_data_length:30844>"
          }
        }
      ],
      "execution_count": 4
    }
  },
  "numerical_summary": {
    "cell_2": [
      19.77711309,
      13.65298573,
      16.29734017,
      13.63923075,
      13.65182599,
      13.63823752,
      13.63823663,
      13.63823658,
      13.63823658,
      13.63823658,
      0.6104878504366782,
      0.0,
      1.0,
      0.0
    ],
    "cell_3": [
      31.68,
      31.36,
      31.04,
      30.72,
      30.4,
      30.08,
      29.76,
      29.44,
      29.12,
      28.8,
      28.48,
      28.16,
      27.84,
      27.52,
      27.2,
      26.88,
      26.56,
      26.24,
      25.92,
      25.6,
      25.28,
      24.96,
      24.64,
      24.32,
      24.00000001,
      23.68000001,
      23.36000003,
      23.04000005,
      22.7200001,
      22.40000019,
      22.08000035,
      21.76000066,
      21.44000121,
      21.12000221,
      20.800004,
      20.4800072,
      20.16001284,
      19.84002276,
      19.52004006,
      19.20007007,
      18.88012179,
      18.56021042,
      18.24036144,
      17.92061721,
      17.60104784,
      17.28176831,
      16.96296572,
      16.64494146,
      16.32817538,
      16.01342077,
      15.70183981,
      15.39518726,
      15.09604125,
      14.80806069,
      14.53621263,
      14.2868645,
      14.06759136,
      13.88655085,
      13.75138127,
      26.33559322,
      13.6382996,
      13.66152403,
      13.73251287,
      13.84382306,
      13.98699937,
      14.15389873,
      14.33754814,
      14.53248988,
      14.73474521,
      14.9415749,
      15.15117942,
      15.36242186,
      15.5746074,
      15.78732358,
      16.00033184,
      16.21349745,
      16.42674606,
      16.64003753,
      16.85335065,
      17.06667445,
      17.2800034,
      17.49333478,
      17.70666726,
      17.92000024,
      18.13333342,
      18.3466667,
      18.56000001,
      18.77333334,
      18.98666667,
      19.2,
      19.41333333,
      19.62666667,
      19.84,
      20.05333333,
      20.26666667,
      20.48,
      20.69333333,
      20.90666667,
      21.12,
      2.0,
      0.0,
      7.0,
      950.0,
      640.0,
      480.0,
      1.0,
      0.01,
      1.0,
      0.01
    ]
  },
  "metadata": {
    "notebook_path": "tut08_opt_load_balancing.ipynb",
    "source_dir": "examples/gettingstarted",
    "total_cells": 4,
    "code_cells": 4,
    "generation_info": {
      "script_version": "2.0",
      "extraction_method": "comprehensive"
    }
  }
}